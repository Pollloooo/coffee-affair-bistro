[file name]: customer.html
[file content begin]
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Customer Menu - Coffee Affair Bistro</title>
    
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@700;800&family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.1.1/css/all.min.css">
    
    <style>
        :root {
            --primary-color: #6f4e37; /* Coffee brown */
            --secondary-color: #c0a080; /* Warm beige */
            --accent-color: #8b5a2b; /* Darker coffee brown */
            --light-color: #f5f1e8; /* Creamy off-white */
            --dark-color: #3e2723; /* Dark chocolate brown */
            --success-color: #4CAF50;
            --warning-color: #ff9800;
            --danger-color: #f44336;
            --info-color: #2196F3;
            --shadow: 0 10px 30px rgba(0, 0, 0, 0.08);
            --transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Poppins', sans-serif;
            background: linear-gradient(135deg, #f9f5f0 0%, #f0e6d6 100%);
            color: var(--dark-color);
            line-height: 1.6;
            overflow-x: hidden;
        }

        /* Enhanced Header Styles */
        .site-header {
            background: linear-gradient(135deg, var(--primary-color) 0%, var(--accent-color) 100%);
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            z-index: 1000;
            padding: 15px 0;
            backdrop-filter: blur(10px);
        }

        .header-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0 30px;
            width: 100%;
            max-width: none;
            margin: 0;
        }

        .welcome-message {
            font-family: 'Playfair Display', serif;
            font-size: 1.5rem;
            color: var(--light-color);
            font-weight: 700;
            white-space: nowrap;
            margin-left: 0;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.2);
        }

        .header-actions {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-right: 0;
        }

        .header-icon {
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 10px 15px;
            border-radius: 8px;
            transition: var(--transition);
            cursor: pointer;
            position: relative;
            font-size: 1.2rem;
            color: var(--light-color);
            background: rgba(255, 255, 255, 0.1);
        }

        .header-icon:hover {
            background: rgba(255, 255, 255, 0.2);
            transform: translateY(-2px);
        }

        .cart-badge, .orders-badge {
            position: absolute;
            top: -8px;
            right: -8px;
            border-radius: 50%;
            width: 20px;
            height: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.7rem;
            font-weight: 600;
            z-index: 1001;
            color: white;
            box-shadow: 0 2px 5px rgba(0,0,0,0.2);
        }

        .cart-badge {
            background: var(--success-color);
        }

        .orders-badge {
            background: var(--info-color);
        }

        .user-dropdown {
            position: relative;
            display: inline-block;
        }

        .dropdown-menu {
            position: absolute;
            top: 100%;
            right: 0;
            background: white;
            border-radius: 8px;
            box-shadow: var(--shadow);
            padding: 10px 0;
            min-width: 150px;
            display: none;
            z-index: 1001;
        }

        .dropdown-menu li {
            list-style: none;
        }

        .dropdown-menu a {
            display: block;
            padding: 10px 20px;
            color: var(--dark-color);
            text-decoration: none;
            transition: var(--transition);
        }

        .dropdown-menu a:hover {
            background-color: #f0f0f0;
            color: var(--primary-color);
        }

        /* Categories Navigation */
        .categories-nav {
            position: fixed;
            top: 80px;
            left: 0;
            right: 0;
            background: var(--light-color);
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
            z-index: 999;
            padding: 15px 0;
            backdrop-filter: blur(10px);
        }

        .categories-container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 0 30px;
            display: flex;
            justify-content: center;
            flex-wrap: wrap;
            gap: 10px;
        }

        .category-tab {
            padding: 10px 20px;
            background: white;
            border: 2px solid transparent;
            border-radius: 50px;
            font-weight: 600;
            color: var(--dark-color);
            cursor: pointer;
            transition: var(--transition);
            display: flex;
            align-items: center;
            gap: 8px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
        }

        .category-tab:hover {
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
            border-color: var(--secondary-color);
        }

        .category-tab.active {
            background: linear-gradient(135deg, var(--primary-color) 0%, var(--accent-color) 100%);
            color: white;
            border-color: var(--primary-color);
        }

        .category-tab i {
            font-size: 1rem;
        }

        /* Main Layout */
        .menu-page-wrapper {
            max-width: 1400px;
            margin: 180px auto 30px;
            padding: 0 30px;
        }

        /* Menu Container */
        .menu-container {
            background: var(--light-color);
            border-radius: 20px;
            padding: 40px;
            box-shadow: var(--shadow);
            border-top: 5px solid var(--primary-color);
            transition: var(--transition);
        }

        .menu-container:hover {
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.1);
        }

        .menu-category-section {
            margin-bottom: 60px;
            opacity: 0;
            transform: translateY(30px);
            animation: fadeInUp 0.8s forwards;
        }

        @keyframes fadeInUp {
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .category-header {
            display: flex;
            align-items: center;
            margin-bottom: 35px;
            padding-bottom: 15px;
            border-bottom: 2px solid var(--secondary-color);
            position: relative;
        }

        .category-header::after {
            content: '';
            position: absolute;
            bottom: -2px;
            left: 0;
            width: 100px;
            height: 2px;
            background: var(--primary-color);
        }

        .menu-category-title {
            font-family: 'Playfair Display', serif;
            color: var(--primary-color);
            font-size: 2.2rem;
            font-weight: 800;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.1);
        }

        /* Product Grid */
        .product-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 30px;
        }

        @media (min-width: 1200px) {
            .product-grid {
                grid-template-columns: repeat(3, 1fr);
            }
        }

        @media (max-width: 768px) {
            .product-grid {
                grid-template-columns: 1fr;
            }
        }

        /* Product Item */
        .product-item {
            background: white;
            border-radius: 20px;
            overflow: hidden;
            box-shadow: var(--shadow);
            transition: var(--transition);
            position: relative;
            border: 1px solid rgba(192, 160, 128, 0.3);
            display: flex;
            flex-direction: column;
            cursor: pointer;
            height: 350px;
            opacity: 0;
            transform: translateY(20px);
            animation: fadeInUp 0.6s forwards;
        }

        .product-item:hover {
            transform: translateY(-10px) scale(1.02);
            box-shadow: 0 20px 40px rgba(111, 78, 55, 0.2);
            border-color: var(--primary-color);
        }

        .product-image-container {
            height: 220px;
            overflow: hidden;
            position: relative;
        }

        .product-item img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            transition: var(--transition);
        }

        .product-item:hover .product-image-container img {
            transform: scale(1.1);
        }

        .product-overlay {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(to bottom, transparent 0%, rgba(0,0,0,0.1) 100%);
            opacity: 0;
            transition: var(--transition);
        }

        .product-item:hover .product-overlay {
            opacity: 1;
        }

        .product-caption {
            padding: 20px 20px 10px;
            font-weight: 600;
            color: var(--dark-color);
            text-align: center;
            flex-grow: 0;
            font-size: 1.1rem;
        }

        .product-price {
            padding: 0 20px 15px;
            font-weight: 700;
            color: var(--primary-color);
            text-align: center;
            flex-grow: 0;
            font-size: 1.3rem;
        }

        .out-of-stock-badge {
            position: absolute;
            top: 15px;
            right: 15px;
            background: var(--danger-color);
            color: white;
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 600;
            z-index: 2;
            box-shadow: 0 3px 10px rgba(0,0,0,0.2);
        }

        .product-item.out-of-stock {
            opacity: 0.7;
            position: relative;
        }

        .product-item.out-of-stock::before {
            content: "";
;
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.1);
            z-index: 1;
            border-radius: 20px;
        }

        /* Product Detail Modal - Full Image Version */
        .product-modal {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.8);
            z-index: 2000;
            display: none;
            align-items: center;
            justify-content: center;
            padding: 20px;
            backdrop-filter: blur(5px);
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .product-modal.open {
            display: flex;
            opacity: 1;
        }

        .product-modal-content {
            background: var(--light-color);
            border-radius: 20px;
            max-width: 1100px;
            width: 100%;
            max-height: 90vh;
            overflow-y: auto;
            box-shadow: 0 25px 50px rgba(0, 0, 0, 0.3);
            position: relative;
            display: grid;
            grid-template-columns: 1fr 1fr; /* Equal columns */
            gap: 0;
            transform: scale(0.9);
            opacity: 0;
            transition: all 0.3s ease;
            aspect-ratio: 16/9;
        }

        .product-modal.open .product-modal-content {
            transform: scale(1);
            opacity: 1;
        }

        .product-modal-image {
            height: 100%;
            overflow: hidden;
            border-radius: 20px 0 0 20px;
            position: relative;
            display: flex;
            align-items: center;
            justify-content: center;
            background: rgba(0, 0, 0, 0.03);
        }

        .product-modal-image img {
            width: 100%;
            height: 100%;
            object-fit: cover; /* Changed to cover to fill space */
            object-position: center;
            min-width: 100%;
            min-height: 100%;
        }

        .product-modal-details {
            padding: 30px;
            display: flex;
            flex-direction: column;
            overflow-y: auto;
            max-height: 80vh;
            position: relative;
        }

        .product-modal-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 25px;
            position: relative;
            padding-right: 50px;
        }

        .product-modal-title {
            font-family: 'Playfair Display', serif;
            color: var(--primary-color);
            font-size: 2.2rem;
            margin-right: 20px;
            font-weight: 800;
            line-height: 1.2;
            flex: 1;
        }

        .product-modal-price {
            font-size: 1.8rem;
            font-weight: 700;
            color: var(--primary-color);
            white-space: nowrap;
            margin-left: 20px;
            z-index: 10;
            position: relative;
        }

        .product-modal-description {
            margin-bottom: 30px;
            color: var(--dark-color);
            line-height: 1.7;
            font-size: 1.05rem;
        }

        .product-modal-customization {
            margin-bottom: 30px;
            flex: 1;
            overflow-y: auto;
            padding-right: 5px;
        }

        .customization-group {
            margin-bottom: 25px;
            background: rgba(255,255,255,0.7);
            padding: 20px;
            border-radius: 15px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.05);
        }

        .customization-group h4 {
            color: var(--accent-color);
            margin-bottom: 15px;
            font-size: 1.2rem;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .customization-group h4 i {
            color: var(--primary-color);
        }

        .option-list {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .option-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px 0;
        }

        .option-label {
            display: flex;
            align-items: center;
            gap: 10px;
            cursor: pointer;
            padding: 8px 12px;
            background: white;
            border-radius: 8px;
            transition: var(--transition);
            border: 2px solid transparent;
            flex: 1;
        }

        .option-label:hover {
            border-color: var(--secondary-color);
            transform: translateY(-2px);
        }

        .option-label input:checked + span {
            font-weight: 600;
            color: var(--primary-color);
        }

        .option-price {
            color: var(--primary-color);
            font-weight: 600;
            font-size: 0.9rem;
        }

        /* Add-ons specific styling */
        .addon-option {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px 15px;
            background: white;
            border-radius: 10px;
            transition: var(--transition);
            border: 2px solid transparent;
            margin-bottom: 8px;
            cursor: pointer;
        }

        .addon-option:hover {
            border-color: var(--secondary-color);
            transform: translateY(-2px);
        }

        .addon-option.selected {
            border-color: var(--primary-color);
            background: rgba(111, 78, 55, 0.05);
        }

        .addon-info {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .addon-checkbox {
            width: 20px;
            height: 20px;
            border-radius: 4px;
            border: 2px solid var(--secondary-color);
            display: flex;
            align-items: center;
            justify-content: center;
            transition: var(--transition);
        }

        .addon-option.selected .addon-checkbox {
            background: var(--primary-color);
            border-color: var(--primary-color);
        }

        .addon-option.selected .addon-checkbox::after {
            content: 'âœ“';
            color: white;
            font-size: 14px;
            font-weight: bold;
        }

        .addon-name {
            font-weight: 500;
            font-size: 1rem;
        }

        .addon-price {
            color: var(--primary-color);
            font-weight: 600;
            font-size: 1rem;
        }

        .modal-add-to-cart {
            width: 100%;
            padding: 15px;
            background: linear-gradient(135deg, var(--primary-color) 0%, var(--accent-color) 100%);
            color: white;
            border: none;
            border-radius: 12px;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition);
            margin-top: 20px;
            box-shadow: 0 5px 15px rgba(111, 78, 55, 0.3);
            position: relative;
            overflow: hidden;
            flex-shrink: 0;
        }

        .modal-add-to-cart::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent);
            transition: left 0.7s;
        }

        .modal-add-to-cart:hover::before {
            left: 100%;
        }

        .modal-add-to-cart:hover {
            background: linear-gradient(135deg, var(--accent-color) 0%, var(--primary-color) 100%);
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(111, 78, 55, 0.4);
        }

        .close-modal {
            position: absolute;
            top: 20px;
            right: 20px;
            background: rgba(0, 0, 0, 0.5);
            color: white;
            border: none;
            border-radius: 50%;
            width: 45px;
            height: 45px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.3rem;
            cursor: pointer;
            z-index: 11;
            transition: var(--transition);
            backdrop-filter: blur(5px);
        }

        .close-modal:hover {
            background: rgba(0, 0, 0, 0.7);
            transform: rotate(90deg);
        }

        /* Enhanced Panels */
        .cart-panel, .order-status-panel {
            position: fixed;
            top: 0;
            right: -400px;
            width: 380px;
            height: 100vh;
            background: var(--light-color);
            box-shadow: -5px 0 25px rgba(0, 0, 0, 0.1);
            transition: var(--transition);
            z-index: 1003;
            display: flex;
            flex-direction: column;
            overflow-y: auto;
            border-left: 4px solid var(--primary-color);
        }

        .cart-panel.open, .order-status-panel.open {
            right: 0;
        }

        .cart-header, .order-status-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 25px;
            border-bottom: 1px solid #eee;
            background: var(--secondary-color);
        }

        .cart-header h3, .order-status-header h3 {
            font-family: 'Playfair Display', serif;
            color: var(--primary-color);
            margin: 0;
            font-size: 1.5rem;
        }

        .close-cart, .close-order-status {
            background: none;
            border: none;
            font-size: 1.2rem;
            cursor: pointer;
            color: var(--dark-color);
            transition: var(--transition);
        }

        .close-cart:hover, .close-order-status:hover {
            transform: rotate(90deg);
        }

        .cart-content, .order-status-content {
            padding: 25px;
            flex: 1;
        }

        /* Enhanced Cart Items */
        .cart-item {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            padding: 15px 0;
            border-bottom: 1px solid #eee;
            transition: var(--transition);
        }

        .cart-item:hover {
            background: rgba(192, 160, 128, 0.1);
            border-radius: 10px;
            padding-left: 10px;
            padding-right: 10px;
        }

        .cart-item:last-child {
            border-bottom: none;
        }

        .cart-item-info {
            display: flex;
            flex-direction: column;
            flex: 1;
            text-align: left;
            align-items: flex-start;
        }

        .cart-item-name {
            font-weight: 700;
            font-size: 1.1rem;
            margin-bottom: 4px;
            color: var(--dark-color);
        }

        .cart-item-customizations {
            font-size: 0.85rem;
            color: #777;
            margin-bottom: 6px;
            font-style: italic;
        }

        .cart-item-price {
            color: var(--primary-color);
            font-weight: 700;
            font-size: 1rem;
            margin-top: 4px;
        }

        .cart-item-actions {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-left: 15px;
        }

        .cart-item-actions button {
            background: var(--primary-color);
            color: white;
            border: none;
            width: 28px;
            height: 28px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: var(--transition);
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
            font-weight: bold;
        }

        .cart-item-actions button:hover {
            background: var(--accent-color);
            transform: scale(1.1);
        }

        .cart-item-quantity {
            width: 40px;
            text-align: center;
            padding: 5px;
            border: 1px solid #ddd;
            border-radius: 8px;
            font-weight: 600;
            margin: 0 5px;
            font-size: 0.9rem;
        }

        .remove-item {
            background: var(--danger-color) !important;
            color: white;
            border: none;
            width: 28px;
            height: 28px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: var(--transition);
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
            margin-left: 5px;
        }

        .remove-item:hover {
            background: #d32f2f !important;
            transform: scale(1.1);
        }

        .cart-footer {
            padding: 25px;
            border-top: 1px solid #eee;
            background: var(--light-color);
        }

        #cart-total {
            font-size: 1.4rem;
            font-weight: 700;
            color: var(--primary-color);
            text-align: right;
            margin: 20px 0;
            padding-top: 20px;
            border-top: 2px solid var(--secondary-color);
        }

        .checkout-btn {
            width: 100%;
            padding: 15px;
            background: var(--success-color);
            color: white;
            border: none;
            border-radius: 12px;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition);
            box-shadow: 0 5px 15px rgba(76, 175, 80, 0.3);
            position: relative;
            overflow: hidden;
        }

        .checkout-btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent);
            transition: left 0.7s;
        }

        .checkout-btn:hover::before {
            left: 100%;
        }

        .checkout-btn:hover {
            background: #3d8b40;
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(76, 175, 80, 0.4);
        }

        .checkout-btn:disabled {
            background: #cccccc;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }

        .cart-overlay, .order-status-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.5);
            z-index: 1002;
            display: none;
        }

        .cart-overlay.open, .order-status-overlay.open {
            display: block;
        }

        /* Order Status Styles */
        .order-card {
            background: white;
            border-radius: 12px;
            padding: 15px;
            margin-bottom: 15px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            transition: var(--transition);
            border-left: 4px solid var(--primary-color);
        }

        .order-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
        }

        .order-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
            flex-wrap: wrap;
            gap: 8px;
        }

        .order-id {
            font-weight: 600;
            color: var(--dark-color);
            font-size: 0.95rem;
        }

        .order-date {
            color: #777;
            font-size: 0.8rem;
        }

        .order-status {
            padding: 4px 8px;
            border-radius: 12px;
            font-weight: 600;
            font-size: 0.75rem;
            text-transform: uppercase;
        }

        .status-new {
            background-color: var(--info-color);
            color: white;
        }

        .status-preparing {
            background-color: var(--warning-color);
            color: white;
        }

        .status-ready {
            background-color: var(--success-color);
            color: white;
        }

        .status-completed {
            background-color: #9e9e9e;
            color: white;
        }

        .status-cancelled {
            background-color: var(--danger-color);
            color: white;
        }

        .order-details {
            margin-bottom: 10px;
        }

        .order-items {
            margin-bottom: 8px;
            max-height: 120px;
            overflow-y: auto;
        }

        .order-item {
            display: flex;
            justify-content: space-between;
            padding: 6px 0;
            border-bottom: 1px solid #eee;
            font-size: 0.85rem;
        }

        .order-item:last-child {
            border-bottom: none;
        }

        .item-name {
            font-weight: 500;
        }

        .item-quantity {
            color: #777;
            font-size: 0.8rem;
        }

        .item-price {
            font-weight: 600;
            color: var(--primary-color);
        }

        .order-total {
            display: flex;
            justify-content: space-between;
            font-weight: 700;
            font-size: 0.95rem;
            padding-top: 8px;
            border-top: 2px solid var(--secondary-color);
            color: var(--primary-color);
        }

        .order-delivery {
            margin: 10px 0;
            padding: 10px 12px;
            border-radius: 8px;
            background: rgba(0, 0, 0, 0.03);
            border: 1px solid #eee;
            font-size: 0.85rem;
            color: var(--dark-color);
        }

        .order-delivery-title {
            font-weight: 600;
            color: var(--primary-color);
            margin-bottom: 6px;
        }

        .order-actions {
            display: flex;
            gap: 8px;
            margin-top: 10px;
        }

        .action-btn {
            padding: 6px 12px;
            border: none;
            border-radius: 6px;
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition);
            font-size: 0.8rem;
            flex: 1;
        }

        .reorder-btn {
            background: var(--primary-color);
            color: white;
        }

        .reorder-btn:hover {
            background: var(--accent-color);
        }

        .cancel-btn {
            background: var(--danger-color);
            color: white;
        }

        .cancel-btn:hover {
            background: #d32f2f;
        }

        .cancel-btn:disabled {
            background: #cccccc;
            cursor: not-allowed;
        }

        /* Status Timeline */
        .status-timeline {
            display: flex;
            justify-content: space-between;
            margin: 15px 0;
            position: relative;
        }

        .status-timeline::before {
            content: '';
            position: absolute;
            top: 12px;
            left: 0;
            right: 0;
            height: 2px;
            background: #e0e0e0;
            z-index: 1;
        }

        .status-step {
            display: flex;
            flex-direction: column;
            align-items: center;
            position: relative;
            z-index: 2;
            flex: 1;
        }

        .status-indicator {
            width: 24px;
            height: 24px;
            border-radius: 50%;
            background: #e0e0e0;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 6px;
            transition: var(--transition);
            font-size: 0.7rem;
        }

        .status-step.active .status-indicator {
            background: var(--primary-color);
            color: white;
        }

        .status-step.completed .status-indicator {
            background: var(--success-color);
            color: white;
        }

        .status-label {
            font-size: 0.7rem;
            text-align: center;
            color: #777;
        }

        .status-step.active .status-label,
        .status-step.completed .status-label {
            color: var(--dark-color);
            font-weight: 600;
        }

        /* Order Progress Bar */
        .order-progress {
            margin: 15px 0;
        }

        .progress-bar {
            height: 6px;
            background: #e0e0e0;
            border-radius: 3px;
            overflow: hidden;
            margin-bottom: 8px;
        }

        .progress-fill {
            height: 100%;
            background: var(--primary-color);
            border-radius: 3px;
            transition: width 0.5s ease;
        }

        .progress-labels {
            display: flex;
            justify-content: space-between;
            font-size: 0.7rem;
            color: #777;
        }

        /* Enhanced Empty States */
        .empty-state {
            text-align: center;
            padding: 40px 20px;
            color: #777;
        }

        .empty-state i {
            font-size: 3rem;
            margin-bottom: 15px;
            color: var(--secondary-color);
        }

        .empty-state h3 {
            font-size: 1.3rem;
            margin-bottom: 10px;
            color: var(--dark-color);
        }

        .empty-state p {
            font-size: 1rem;
        }

        .empty-cart-message {
            text-align: center;
            color: #888;
            font-style: italic;
            padding: 40px 0;
            font-size: 1.1rem;
        }

        /* Floating particles for visual effect */
        .particles {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: -1;
        }

        .particle {
            position: absolute;
            background: rgba(192, 160, 128, 0.2);
            border-radius: 50%;
            animation: float 15s infinite linear;
        }

        @keyframes float {
            0% {
                transform: translateY(0) rotate(0deg);
                opacity: 0;
            }
            10% {
                opacity: 1;
            }
            90% {
                opacity: 1;
            }
            100% {
                transform: translateY(-1000px) rotate(720deg);
                opacity: 0;
            }
        }

        /* =========================================== */
        /* CHECKOUT MODAL STYLES */
        /* =========================================== */
        .checkout-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.8);
            z-index: 2001;
            display: none;
            backdrop-filter: blur(5px);
        }

        .checkout-overlay.open {
            display: block;
        }

        .checkout-modal {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            z-index: 2002;
            display: none;
            align-items: center;
            justify-content: center;
            padding: 20px;
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .checkout-modal.open {
            display: flex;
            opacity: 1;
        }

        .checkout-content {
            background: var(--light-color);
            border-radius: 20px;
            width: 100%;
            max-width: 800px;
            max-height: 90vh;
            display: flex;
            flex-direction: column;
            box-shadow: 0 25px 50px rgba(0, 0, 0, 0.3);
            transform: scale(0.95);
            transition: transform 0.3s ease;
        }

        .checkout-modal.open .checkout-content {
            transform: scale(1);
        }

        .checkout-header {
            padding: 25px 30px;
            border-bottom: 2px solid var(--secondary-color);
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: linear-gradient(135deg, var(--primary-color) 0%, var(--accent-color) 100%);
            border-radius: 20px 20px 0 0;
            color: white;
        }

        .checkout-header h2 {
            font-family: 'Playfair Display', serif;
            font-size: 1.8rem;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .close-checkout {
            background: rgba(255, 255, 255, 0.2);
            border: none;
            color: white;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: var(--transition);
        }

        .close-checkout:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: rotate(90deg);
        }

        .checkout-body {
            padding: 30px;
            overflow-y: auto;
            flex: 1;
        }

        .checkout-section {
            background: white;
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 25px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05);
            border: 1px solid rgba(192, 160, 128, 0.2);
        }

        .checkout-section h3 {
            color: var(--primary-color);
            margin-bottom: 20px;
            font-size: 1.3rem;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        /* Order Summary */
        .order-summary-items {
            margin-bottom: 20px;
            max-height: 200px;
            overflow-y: auto;
            padding-right: 10px;
        }

        .checkout-item {
            display: flex;
            justify-content: space-between;
            padding: 10px 0;
            border-bottom: 1px solid #eee;
        }

        .checkout-item:last-child {
            border-bottom: none;
        }

        .item-details {
            flex: 1;
        }

        .item-name {
            font-weight: 600;
            color: var(--dark-color);
            display: block;
        }

        .item-customization {
            font-size: 0.85rem;
            color: #777;
            font-style: italic;
            margin-top: 3px;
        }

        .item-price {
            font-weight: 600;
            color: var(--primary-color);
            white-space: nowrap;
            margin-left: 15px;
        }

        .order-totals {
            border-top: 2px solid var(--secondary-color);
            padding-top: 15px;
        }

        .total-row {
            display: flex;
            justify-content: space-between;
            margin-bottom: 8px;
            color: var(--dark-color);
        }

        .total-row.total {
            font-size: 1.3rem;
            font-weight: 700;
            color: var(--primary-color);
            margin-top: 10px;
            padding-top: 10px;
            border-top: 2px solid var(--secondary-color);
        }

        /* Delivery Options */
        .delivery-options {
            display: flex;
            gap: 15px;
            margin-bottom: 25px;
        }

        .delivery-option {
            flex: 1;
            padding: 15px;
            border: 2px solid #ddd;
            border-radius: 12px;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 10px;
            cursor: pointer;
            transition: var(--transition);
            background: white;
        }

        .delivery-option.active {
            border-color: var(--primary-color);
            background: rgba(111, 78, 55, 0.05);
        }

        .delivery-option i {
            font-size: 1.5rem;
            color: var(--primary-color);
        }

        .delivery-option span {
            font-weight: 600;
            color: var(--dark-color);
        }

        /* Form Styles */
        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: var(--dark-color);
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .form-group input,
        .form-group textarea,
        .form-group select {
            width: 100%;
            padding: 12px 15px;
            border: 2px solid #ddd;
            border-radius: 10px;
            font-family: 'Poppins', sans-serif;
            font-size: 1rem;
            transition: var(--transition);
            background: white;
        }

        .form-group input:focus,
        .form-group textarea:focus,
        .form-group select:focus {
            border-color: var(--primary-color);
            outline: none;
            box-shadow: 0 0 0 3px rgba(111, 78, 55, 0.1);
        }

        .form-help {
            display: block;
            margin-top: 5px;
            color: #777;
            font-size: 0.85rem;
        }

        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
        }

        /* Payment Options */
        .payment-options {
            display: flex;
            flex-direction: column;
            gap: 10px;
            margin-bottom: 25px;
        }

        .payment-option {
            display: flex;
            align-items: center;
            padding: 15px;
            border: 2px solid #ddd;
            border-radius: 12px;
            cursor: pointer;
            transition: var(--transition);
            background: white;
            gap: 15px;
        }

        .payment-option.active {
            border-color: var(--primary-color);
            background: rgba(111, 78, 55, 0.05);
        }

        .payment-icon {
            width: 50px;
            height: 50px;
            border-radius: 10px;
            background: var(--secondary-color);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            color: var(--primary-color);
        }

        .payment-info {
            flex: 1;
        }

        .payment-info h4 {
            color: var(--dark-color);
            margin-bottom: 5px;
        }

        .payment-info p {
            color: #777;
            font-size: 0.9rem;
        }

        .payment-check {
            color: #ddd;
            font-size: 1.5rem;
            transition: var(--transition);
        }

        .payment-option.active .payment-check {
            color: var(--success-color);
        }

        /* Payment Details */
        .payment-details {
            background: rgba(255, 255, 255, 0.7);
            border-radius: 12px;
            padding: 20px;
            border: 1px solid #eee;
        }

        .ewallet-details {
            display: grid;
            grid-template-columns: 1fr 2fr;
            gap: 25px;
        }

        .qr-code-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 10px;
        }

        .qr-placeholder {
            width: 150px;
            height: 150px;
            background: white;
            border: 2px dashed var(--secondary-color);
            border-radius: 12px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            color: var(--primary-color);
        }

        .qr-placeholder i {
            font-size: 3rem;
            margin-bottom: 10px;
        }

        .card-details {
            max-width: 400px;
            margin: 0 auto;
        }

        /* Checkout Footer */
        .checkout-footer {
            padding: 25px 30px;
            border-top: 2px solid var(--secondary-color);
            background: white;
            border-radius: 0 0 20px 20px;
        }

        .checkout-summary {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin-bottom: 20px;
            padding: 15px;
            background: var(--light-color);
            border-radius: 12px;
        }

        .summary-item {
            display: flex;
            flex-direction: column;
            gap: 5px;
        }

        .summary-item span:first-child {
            font-size: 0.9rem;
            color: #777;
        }

        .summary-item span:last-child {
            font-weight: 600;
            color: var(--primary-color);
        }

        .confirm-order-btn {
            width: 100%;
            padding: 18px;
            background: linear-gradient(135deg, var(--success-color) 0%, #3d8b40 100%);
            color: white;
            border: none;
            border-radius: 12px;
            font-size: 1.2rem;
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition);
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            box-shadow: 0 5px 20px rgba(76, 175, 80, 0.3);
        }

        .confirm-order-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(76, 175, 80, 0.4);
        }

        .confirm-order-btn:disabled {
            background: #cccccc;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }

        .terms-notice {
            text-align: center;
            margin-top: 15px;
            color: #777;
            font-size: 0.85rem;
        }

        .terms-notice a {
            color: var(--primary-color);
            text-decoration: none;
        }

        .terms-notice a:hover {
            text-decoration: underline;
        }

        /* Store Details */
        .store-details {
            background: rgba(192, 160, 128, 0.1);
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 20px;
        }

        .store-details h4 {
            color: var(--primary-color);
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .store-details p {
            margin-bottom: 8px;
            display: flex;
            align-items: center;
            gap: 10px;
            color: var(--dark-color);
        }

        .store-details i {
            color: var(--primary-color);
            width: 20px;
        }

        /* Responsive Design */
        @media (max-width: 1200px) {
            .product-modal-content {
                max-width: 1000px;
                grid-template-columns: 1.2fr 0.8fr;
            }
        }

        @media (max-width: 992px) {
            .product-modal-content {
                grid-template-columns: 1fr;
                max-width: 700px;
                aspect-ratio: auto;
            }
            
            .product-modal-image {
                height: 400px;
                border-radius: 20px 20px 0 0;
            }
            
            .product-modal-details {
                padding: 25px;
            }
            
            .ewallet-details {
                grid-template-columns: 1fr;
            }
        }

        @media (max-width: 768px) {
            .menu-page-wrapper {
                margin-top: 160px;
                padding: 0 15px;
            }
            
            .header-content {
                padding: 0 15px;
            }
            
            .categories-nav {
                top: 70px;
            }
            
            .categories-container {
                padding: 0 15px;
                justify-content: flex-start;
                overflow-x: auto;
                white-space: nowrap;
                padding-bottom: 10px;
            }
            
            .category-tab {
                padding: 8px 15px;
                font-size: 0.9rem;
            }
            
            .cart-panel, .order-status-panel {
                width: 100%;
                right: -100%;
            }
            
            .product-grid {
                grid-template-columns: 1fr;
            }
            
            .menu-container {
                padding: 25px;
            }
            
            .product-modal-content {
                max-width: 95vw;
            }
            
            .product-modal-image {
                height: 350px;
            }
            
            .product-modal-details {
                padding: 20px;
            }
            
            .product-modal-title {
                font-size: 1.8rem;
            }
            
            .product-modal-price {
                font-size: 1.5rem;
            }
            
            .checkout-modal {
                padding: 10px;
            }
            
            .checkout-header {
                padding: 20px;
            }
            
            .checkout-body {
                padding: 20px;
            }
            
            .checkout-section {
                padding: 20px;
            }
            
            .delivery-options {
                flex-direction: column;
            }
            
            .checkout-summary {
                grid-template-columns: 1fr;
            }
            
            .form-row {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <!-- Floating particles for visual effect -->
    <div class="particles" id="particles"></div>

    <header class="site-header">
        <div class="header-content">
            <div class="welcome-message" id="welcome-message">WELCOME, GUEST</div>
            <div class="header-actions">
                <!-- Order Status Icon -->
                <div class="header-icon" id="order-status-icon">
                    <i class="fas fa-clipboard-list"></i>
                    <div class="orders-badge" id="orders-badge">0</div>
                </div>
                <!-- Cart Icon -->
                <div class="header-icon" id="cart-icon">
                    <i class="fas fa-shopping-cart"></i>
                    <div class="cart-badge" id="cart-badge">0</div>
                </div>

                <!-- User Dropdown -->
                <div class="user-dropdown">
                    <div class="header-icon" id="user-icon">
                        <i class="fas fa-user"></i>
                    </div>
                    <ul class="dropdown-menu" id="user-dropdown-menu">
                        <li><a href="index.html">Home</a></li>
                        <li><a href="#" id="logout-link">Logout</a></li>
                    </ul>
                </div>
            </div>
        </div>
    </header>

    <!-- Categories Navigation -->
    <nav class="categories-nav">
        <div class="categories-container" id="categories-container">
            <!-- Categories will be dynamically inserted here -->
        </div>
    </nav>

    <!-- Product Detail Modal -->
    <div class="product-modal" id="product-modal">
        <div class="product-modal-content">
            <button class="close-modal" id="close-modal">
                <i class="fas fa-times"></i>
            </button>
            <div class="product-modal-image">
                <img id="modal-image" src="" alt="Product Image">
            </div>
            <div class="product-modal-details">
                <div class="product-modal-header">
                    <h2 class="product-modal-title" id="modal-title">Product Name</h2>
                    <div class="product-modal-price" id="modal-price">â‚±0.00</div>
                </div>
                <p class="product-modal-description" id="modal-description">Product description will appear here.</p>
                
                <div class="product-modal-customization" id="modal-customization">
                    <!-- Customization options will be dynamically inserted here -->
                </div>
                
                <button class="modal-add-to-cart" id="modal-add-to-cart">Add to Cart</button>
            </div>
        </div>
    </div>

    <!-- Order Status Panel -->
    <div class="order-status-overlay" id="order-status-overlay"></div>
    <div class="order-status-panel" id="order-status-panel">
        <div class="order-status-header">
            <h3>Your Orders</h3>
            <button class="close-order-status" id="close-order-status">
                <i class="fas fa-times"></i>
            </button>
        </div>
        <div class="order-status-content" id="order-status-content">
            <!-- Orders will be dynamically inserted here -->
        </div>
    </div>

    <!-- Cart Panel -->
    <div class="cart-overlay" id="cart-overlay"></div>
    <div class="cart-panel" id="cart-panel">
        <div class="cart-header">
            <h3>Your Cart</h3>
            <button class="close-cart" id="close-cart">
                <i class="fas fa-times"></i>
            </button>
        </div>
        <div class="cart-content">
            <div id="cart-items">
                <!-- Cart items will be dynamically inserted here -->
            </div>
        </div>
        <div class="cart-footer">
            <div id="cart-total">Total: â‚±0.00</div>
            <button id="checkout-btn" class="checkout-btn" disabled>Checkout</button>
        </div>
    </div>

    <!-- Checkout Modal -->
    <div class="checkout-overlay" id="checkout-overlay"></div>
    <div class="checkout-modal" id="checkout-modal">
        <div class="checkout-content">
            <div class="checkout-header">
                <h2><i class="fas fa-shopping-bag"></i> Complete Your Order</h2>
                <button class="close-checkout" id="close-checkout">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            
            <div class="checkout-body">
                <!-- Order Summary -->
                <div class="checkout-section" id="order-summary-section">
                    <h3><i class="fas fa-receipt"></i> Order Summary</h3>
                    <div class="order-summary-items" id="checkout-items">
                        <!-- Items will be populated here -->
                    </div>
                    <div class="order-totals">
                        <div class="total-row">
                            <span>Subtotal</span>
                            <span id="checkout-subtotal">â‚±0.00</span>
                        </div>
                        <div class="total-row">
                            <span>Delivery Fee</span>
                            <span id="delivery-fee">â‚±50.00</span>
                        </div>
                        <div class="total-row total">
                            <span>Total Amount</span>
                            <span id="checkout-total">â‚±0.00</span>
                        </div>
                    </div>
                </div>
                
                <!-- Delivery Information -->
                <div class="checkout-section">
                    <h3><i class="fas fa-truck"></i> Delivery Information</h3>
                    <div class="delivery-options">
                        <div class="delivery-option active" data-type="delivery">
                            <i class="fas fa-motorcycle"></i>
                            <span>Delivery</span>
                        </div>
                        <div class="delivery-option" data-type="pickup">
                            <i class="fas fa-store"></i>
                            <span>Pickup</span>
                        </div>
                    </div>
                    
                    <div class="delivery-form" id="delivery-form">
                        <div class="form-group">
                            <label for="customer-name"><i class="fas fa-user"></i> Full Name</label>
                            <input type="text" id="customer-name" placeholder="Enter your full name" value="">
                        </div>
                        <div class="form-group">
                            <label for="customer-phone"><i class="fas fa-phone"></i> Phone Number</label>
                            <input type="tel" id="customer-phone" placeholder="09XXXXXXXXX" value="">
                        </div>
                        <div class="form-group">
                            <label for="customer-address"><i class="fas fa-map-marker-alt"></i> Delivery Address</label>
                            <textarea id="customer-address" placeholder="Enter complete address including street, barangay, city" rows="3"></textarea>
                            <small class="form-help">We'll deliver to this address</small>
                        </div>
                        <div class="form-group">
                            <label for="delivery-instructions"><i class="fas fa-sticky-note"></i> Delivery Instructions (Optional)</label>
                            <textarea id="delivery-instructions" placeholder="e.g., Call upon arrival, Leave at gate, etc." rows="2"></textarea>
                        </div>
                    </div>
                    
                    <div class="pickup-form" id="pickup-form" style="display: none;">
                        <div class="pickup-info">
                            <div class="store-details">
                                <h4><i class="fas fa-store"></i> Coffee Affair Bistro</h4>
                                <p><i class="fas fa-map-marker-alt"></i> 123 Coffee Street, Makati City, Metro Manila</p>
                                <p><i class="fas fa-clock"></i> Open 7:00 AM - 10:00 PM daily</p>
                                <p><i class="fas fa-phone"></i> (02) 8123-4567</p>
                            </div>
                            <div class="form-group">
                                <label for="pickup-name"><i class="fas fa-user"></i> Pickup Name</label>
                                <input type="text" id="pickup-name" placeholder="Name for pickup order" value="">
                            </div>
                            <div class="form-group">
                                <label for="pickup-time"><i class="fas fa-clock"></i> Preferred Pickup Time</label>
                                <select id="pickup-time">
                                    <option value="asap">As soon as possible (15-20 mins)</option>
                                    <option value="30min">In 30 minutes</option>
                                    <option value="1hour">In 1 hour</option>
                                    <option value="specific">Specific time</option>
                                </select>
                            </div>
                            <div class="form-group" id="specific-time-group" style="display: none;">
                                <label for="specific-time"><i class="fas fa-calendar-alt"></i> Specific Time</label>
                                <input type="datetime-local" id="specific-time">
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Payment Method -->
                <div class="checkout-section">
                    <h3><i class="fas fa-credit-card"></i> Payment Method</h3>
                    <div class="payment-options">
                        <div class="payment-option active" data-method="cash">
                            <div class="payment-icon">
                                <i class="fas fa-money-bill-wave"></i>
                            </div>
                            <div class="payment-info">
                                <h4>Cash on Delivery</h4>
                                <p>Pay with cash when you receive your order</p>
                            </div>
                            <div class="payment-check">
                                <i class="fas fa-check-circle"></i>
                            </div>
                        </div>
                        
                        <div class="payment-option" data-method="gcash">
                            <div class="payment-icon">
                                <i class="fas fa-mobile-alt"></i>
                            </div>
                            <div class="payment-info">
                                <h4>GCash</h4>
                                <p>Pay using GCash e-wallet</p>
                            </div>
                            <div class="payment-check">
                                <i class="fas fa-check-circle"></i>
                            </div>
                        </div>
                        
                        <div class="payment-option" data-method="maya">
                            <div class="payment-icon">
                                <i class="fas fa-wallet"></i>
                            </div>
                            <div class="payment-info">
                                <h4>Maya</h4>
                                <p>Pay using Maya wallet</p>
                            </div>
                            <div class="payment-check">
                                <i class="fas fa-check-circle"></i>
                            </div>
                        </div>
                        
                        <div class="payment-option" data-method="card">
                            <div class="payment-icon">
                                <i class="fas fa-credit-card"></i>
                            </div>
                            <div class="payment-info">
                                <h4>Credit/Debit Card</h4>
                                <p>Pay with Visa, Mastercard, or JCB</p>
                            </div>
                            <div class="payment-check">
                                <i class="fas fa-check-circle"></i>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Payment Method Details -->
                    <div class="payment-details" id="cash-details">
                        <div class="payment-instruction">
                            <p><i class="fas fa-info-circle"></i> Please prepare exact amount for delivery. Change may not be available.</p>
                        </div>
                    </div>
                    
                    <div class="payment-details" id="gcash-details" style="display: none;">
                        <div class="ewallet-details">
                            <div class="qr-code-container">
                                <div class="qr-placeholder">
                                    <i class="fas fa-qrcode"></i>
                                    <p>Scan to Pay</p>
                                </div>
                            </div>
                            <div class="ewallet-info">
                                <p><strong>GCash Number:</strong> 0917 123 4567</p>
                                <p><strong>Account Name:</strong> Coffee Affair Bistro</p>
                                <div class="form-group">
                                    <label for="gcash-reference">Reference Number (Optional)</label>
                                    <input type="text" id="gcash-reference" placeholder="Enter GCash reference number">
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="payment-details" id="maya-details" style="display: none;">
                        <div class="ewallet-details">
                            <div class="qr-code-container">
                                <div class="qr-placeholder">
                                    <i class="fas fa-qrcode"></i>
                                    <p>Scan to Pay</p>
                                </div>
                            </div>
                            <div class="ewallet-info">
                                <p><strong>Maya Number:</strong> 0918 765 4321</p>
                                <p><strong>Account Name:</strong> Coffee Affair Bistro</p>
                                <div class="form-group">
                                    <label for="maya-reference">Reference Number (Optional)</label>
                                    <input type="text" id="maya-reference" placeholder="Enter Maya reference number">
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="payment-details" id="card-details" style="display: none;">
                        <div class="card-details">
                            <div class="form-group">
                                <label for="card-number">Card Number</label>
                                <input type="text" id="card-number" placeholder="1234 5678 9012 3456">
                            </div>
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="card-expiry">Expiry Date</label>
                                    <input type="text" id="card-expiry" placeholder="MM/YY">
                                </div>
                                <div class="form-group">
                                    <label for="card-cvv">CVV</label>
                                    <input type="password" id="card-cvv" placeholder="123" maxlength="3">
                                </div>
                            </div>
                            <div class="form-group">
                                <label for="card-name">Name on Card</label>
                                <input type="text" id="card-name" placeholder="Juan Dela Cruz">
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="checkout-footer">
                <div class="checkout-summary">
                    <div class="summary-item">
                        <span>Payment Method:</span>
                        <span id="selected-payment-method">Cash on Delivery</span>
                    </div>
                    <div class="summary-item">
                        <span>Delivery Type:</span>
                        <span id="selected-delivery-type">Delivery</span>
                    </div>
                </div>
                <button class="confirm-order-btn" id="confirm-order-btn">
                    <i class="fas fa-lock"></i> Place Order â€¢ â‚±<span id="confirm-total">0.00</span>
                </button>
                <p class="terms-notice">
                    By placing your order, you agree to our <a href="#">Terms of Service</a> and <a href="#">Privacy Policy</a>
                </p>
            </div>
        </div>
    </div>

    <main class="menu-page-wrapper">
        <!-- Container for all menu categories -->
        <div class="menu-container" id="menu-container">
            <!-- Menu sections will be dynamically inserted here -->
        </div>
    </main>

    <script>
        // Create floating particles for visual effect
        function createParticles() {
            const particlesContainer = document.getElementById('particles');
            const particleCount = 20;
            
            for (let i = 0; i < particleCount; i++) {
                const particle = document.createElement('div');
                particle.classList.add('particle');
                
                const size = Math.random() * 10 + 5;
                particle.style.width = `${size}px`;
                particle.style.height = `${size}px`;
                
                particle.style.left = `${Math.random() * 100}%`;
                particle.style.top = `${Math.random() * 100}%`;
                
                const duration = Math.random() * 20 + 10;
                const delay = Math.random() * 5;
                particle.style.animationDuration = `${duration}s`;
                particle.style.animationDelay = `${delay}s`;
                
                particlesContainer.appendChild(particle);
            }
        }

        // Replace the ENTIRE loadMenuData function with this:
        async function loadMenuData() {
            console.log('Loading menu data from server...');
            
            // Cache key for localStorage
            const CACHE_KEY = 'coffeeShopMenuData_v2';
            const CACHE_TIMESTAMP_KEY = 'coffeeShopMenuTimestamp';
            
            try {
                // Try to fetch from server FIRST (always try to get fresh data)
                const timestamp = new Date().getTime();
                const response = await fetch(`/menu-data.json?t=${timestamp}`);
                
                if (response.ok) {
                    const serverData = await response.json();
                    console.log('âœ… Successfully loaded menu data from server:', {
                        version: serverData.version || 'unknown',
                        categories: serverData.categories?.length || 0,
                        lastUpdated: serverData.lastUpdated || 'unknown'
                    });
                    
                    // Save to localStorage for offline use
                    localStorage.setItem(CACHE_KEY, JSON.stringify(serverData));
                    localStorage.setItem(CACHE_TIMESTAMP_KEY, Date.now().toString());
                    
                    return serverData;
                }
            } catch (error) {
                console.log('âš ï¸ Could not fetch from server, checking cache...', error.message);
            }
            
            // Fallback to localStorage cache if server fetch fails
            const cachedData = localStorage.getItem(CACHE_KEY);
            if (cachedData) {
                try {
                    const data = JSON.parse(cachedData);
                    console.log('ðŸ“¦ Using cached menu data (offline mode)');
                    return data;
                } catch (error) {
                    console.error('Error parsing cached data:', error);
                }
            }
            
            // Ultimate fallback: default data
            console.warn('âš ï¸ No server data and no cache, using default menu');
            return getDefaultMenuData();
        }

        // Auto-check for updates every 30 seconds
        function setupMenuAutoRefresh() {
            setInterval(async () => {
                try {
                    const timestamp = new Date().getTime();
                    const response = await fetch(`/menu-data.json?t=${timestamp}`);
                    
                    if (response.ok) {
                        const serverData = await response.json();
                        const cachedData = JSON.parse(localStorage.getItem('coffeeShopMenuData_v2') || '{}');
                        
                        // Check if server data is newer
                        const serverVersion = serverData.version || 0;
                        const cachedVersion = cachedData.version || 0;
                        
                        if (serverVersion > cachedVersion) {
                            console.log('ðŸ”„ Menu updated detected! Refreshing...');
                            localStorage.setItem('coffeeShopMenuData_v2', JSON.stringify(serverData));
                            localStorage.setItem('coffeeShopMenuTimestamp', Date.now().toString());
                            
                            // Show notification to user
                            showNotification('Menu has been updated! Refreshing...', 'info');
                            
                            // Reload the menu after 2 seconds
                            setTimeout(() => {
                                generateMenu();
                                showNotification('Menu refreshed with latest items!', 'success');
                            }, 2000);
                        }
                    }
                } catch (error) {
                    // Silent fail - it's okay if auto-refresh fails
                }
            }, 30000); // Check every 30 seconds
        }

        // Create a menu-data.json file in your Netlify site root
        // Helper function for default customizations
        function getDefaultCustomizations() {
            return [
                {
                    id: 'temperature',
                    name: 'Temperature',
                    type: 'single',
                    required: true,
                    categories: ['coffee', 'tea', 'non-coffee', 'signature-drinks'],
                    options: [
                        { id: 'hot', name: 'Hot', price: 0 },
                        { id: 'cold', name: 'Cold', price: 10 }
                    ]
                },
                {
                    id: 'size',
                    name: 'Size',
                    type: 'single',
                    required: true,
                    categories: ['coffee', 'tea', 'non-coffee', 'signature-drinks', 'appetizers'],
                    options: [
                        { id: 'small', name: 'Small', price: 0 },
                        { id: 'medium', name: 'Medium', price: 15 }
                    ]
                }
            ];
        }

        // Get default menu data structure
        function getDefaultMenuData() {
            return {
                categories: [
                    {
                        id: 'coffee',
                        name: 'Coffee',
                        description: 'Our premium coffee selection',
                        image: 'https://images.unsplash.com/photo-1495474472287-4d71bcdd2085?ixlib=rb-4.0.3&auto=format&fit=crop&w=500&q=60',
                        displayOrder: 1,
                        visible: true,
                        items: [
                            {
                                id: 'americano',
                                name: 'Americano',
                                description: 'Rich espresso with hot water',
                                price: 110,
                                cost: 40,
                                image: 'https://images.unsplash.com/photo-1498804103079-a6351b050096?ixlib=rb-4.0.3&auto=format&fit=crop&w=500&q=80',
                                sku: 'COF-001',
                                featured: false,
                                seasonal: false,
                                available: true,
                                trackStock: true,
                                stock: 50
                            },
                            {
                                id: 'cappuccino',
                                name: 'Cappuccino',
                                description: 'Espresso with steamed milk and foam',
                                price: 130,
                                cost: 45,
                                image: 'https://images.unsplash.com/photo-1570197788417-0e82375c9371?ixlib=rb-4.0.3&auto=format&fit=crop&w=500&q=80',
                                sku: 'COF-002',
                                featured: true,
                                seasonal: false,
                                available: true,
                                trackStock: true,
                                stock: 30
                            }
                        ]
                    },
                    {
                        id: 'tea',
                        name: 'Tea',
                        description: 'Various tea selections',
                        image: 'https://images.unsplash.com/photo-1560512823-829485b8bf24?ixlib=rb-4.0.3&auto=format&fit=crop&w=500&q=80',
                        displayOrder: 2,
                        visible: true,
                        items: [
                            {
                                id: 'green-tea',
                                name: 'Green Tea',
                                description: 'Refreshing green tea leaves',
                                price: 90,
                                cost: 30,
                                image: 'https://images.unsplash.com/photo-1560512823-829485b8bf24?ixlib=rb-4.0.3&auto=format&fit=crop&w=500&q=80',
                                sku: 'TEA-001',
                                featured: false,
                                seasonal: false,
                                available: true,
                                trackStock: true,
                                stock: 40
                            }
                        ]
                    }
                ],
                customizations: getDefaultCustomizations()
            };
        }

        // Check and sync data automatically
        function checkAndSyncData() {
            // Check for data sync every 2 seconds
            setInterval(() => {
                const saved = localStorage.getItem('coffeeShopMenuData');
                if (saved) {
                    // Data exists, update menu if needed
                    const menuContainer = document.getElementById('menu-container');
                    
                    // Only regenerate if menu is empty
                    if (menuContainer && menuContainer.children.length === 0) {
                        console.log('Auto-refreshing menu with stored data');
                        generateMenu();
                    }
                }
            }, 2000);
        }

        // Load order data from localStorage
        function loadOrders() {
            const savedOrders = localStorage.getItem('bistroOrders');
            if (savedOrders) {
                return JSON.parse(savedOrders);
            }
            return [];
        }

        // Get current user
        function getCurrentUser() {
            const loggedInUser = JSON.parse(localStorage.getItem('bistroLoggedInUser'));
            return loggedInUser || { name: 'Guest' };
        }

        // Filter orders by current user
        function getUserOrders() {
            const orders = loadOrders();
            const user = getCurrentUser();
            
            // For demo purposes, if no user is logged in, show all orders
            // In a real app, you would filter by user ID
            if (user.name === 'Guest') {
                return orders;
            }
            
            return orders.filter(order => order.customerName === user.name);
        }

        function updateOrdersBadge() {
            const orders = getUserOrders();
            const activeOrders = orders.filter(order => {
                const status = order.status.toLowerCase();
                return status !== 'completed' && status !== 'cancelled';
            });
            
            const ordersBadge = document.getElementById('orders-badge');
            if (ordersBadge) {
                ordersBadge.textContent = activeOrders.length;
                
                // Update badge visibility
                if (activeOrders.length > 0) {
                    ordersBadge.style.display = 'flex';
                    ordersBadge.style.animation = 'pulse 2s infinite';
                } else {
                    ordersBadge.style.display = 'none';
                }
            }
        }

        // Add CSS animation for badge pulse
        const style = document.createElement('style');
        style.textContent = `
            @keyframes pulse {
                0% {
                    transform: scale(1);
                    box-shadow: 0 0 0 0 rgba(33, 150, 243, 0.7);
                }
                70% {
                    transform: scale(1.1);
                    box-shadow: 0 0 0 10px rgba(33, 150, 243, 0);
                }
                100% {
                    transform: scale(1);
                    box-shadow: 0 0 0 0 rgba(33, 150, 243, 0);
                }
            }
        `;
        document.head.appendChild(style);

        // Initialize order status on page load
        document.addEventListener('DOMContentLoaded', function() {
            initializeOrderStatus();
            
            // Also initialize when menu is generated
            setTimeout(initializeOrderStatus, 500);
        });

        // Update the existing logout functionality to also reset order status
        const logoutLink = document.getElementById('logout-link');
        if (logoutLink) {
            logoutLink.addEventListener('click', (e) => {
                e.preventDefault();
                
                // Clear user data
                localStorage.removeItem('bistroLoggedInUser');
                localStorage.removeItem('customerCart');
                
                // Reset order status badge
                const ordersBadge = document.getElementById('orders-badge');
                if (ordersBadge) {
                    ordersBadge.textContent = '0';
                    ordersBadge.style.display = 'none';
                }
                
                // Redirect to login page
                window.location.href = 'login.html';
            });
        }

        // Helper function to get customization by ID
        function getCustomizationById(customizationId) {
            const menuData = loadMenuData();
            return menuData.customizations.find(custom => custom.id === customizationId);
        }

        // Helper function to get product category
        function getProductCategory(productId) {
            const menuData = loadMenuData();
            for (const category of menuData.categories) {
                if (category.items.some(item => item.id === productId)) {
                    return category.id;
                }
            }
            return null;
        }

        // Generate the menu based on loaded data
        async function generateMenu() {
            console.log('Generating menu from loaded data...');
            const menuData = await loadMenuData();
            const categoriesContainer = document.getElementById('categories-container');
            const menuContainer = document.getElementById('menu-container');
            
            categoriesContainer.innerHTML = '';
            menuContainer.innerHTML = '';
            
            const sortedCategories = menuData.categories.sort((a, b) => a.displayOrder - b.displayOrder);
            
            sortedCategories.forEach((category, index) => {
                if (!category.visible) {
                    console.log(`Skipping hidden category: ${category.name}`);
                    return;
                }
                
                // Create category tab
                const categoryTab = document.createElement('div');
                const iconClass = getCategoryIcon(category.name);
                categoryTab.className = `category-tab ${index === 0 ? 'active' : ''}`;
                categoryTab.dataset.category = category.id;
                categoryTab.innerHTML = `
                    <i class="${iconClass}"></i>
                    <span>${category.name}</span>
                `;
                categoriesContainer.appendChild(categoryTab);
                
                // Create menu section
                const section = document.createElement('section');
                section.id = category.id;
                section.className = 'menu-category-section';
                section.style.animationDelay = `${index * 0.1}s`;
                
                let itemsHTML = '';
                const availableItems = category.items.filter(item => item.available);
                
                if (availableItems.length === 0) {
                    itemsHTML = '<p class="empty-message" style="text-align: center; color: #777; font-style: italic; padding: 40px 0;">No items available in this category</p>';
                } else {
                    availableItems.forEach((item, itemIndex) => {
                        const isOutOfStock = item.trackStock && item.stock <= 0;
                        const outOfStockClass = isOutOfStock ? 'out-of-stock' : '';
                        const outOfStockBadge = isOutOfStock ? '<div class="out-of-stock-badge">Out of Stock</div>' : '';
                        
                        // Create a clean product data string
                        const productData = encodeURIComponent(JSON.stringify(item));
                        
                        itemsHTML += `
                            <div class="product-item ${outOfStockClass}" data-product="${productData}" style="animation-delay: ${itemIndex * 0.05}s">
                                ${outOfStockBadge}
                                <div class="product-image-container">
                                    <img src="${item.image}" 
                                        alt="${item.name}"
                                        onerror="this.onerror=null; this.src='https://images.unsplash.com/photo-1559056199-641a0ac8b55e?ixlib=rb-4.0.3&auto=format&fit=crop&w=500&q=60'">
                                    <div class="product-overlay"></div>
                                </div>
                                <p class="product-caption">${item.name}</p>
                                <p class="product-price">â‚±${item.price}</p>
                            </div>
                        `;
                    });
                }
                
                section.innerHTML = `
                    <div class="category-header">
                        <h2 class="menu-category-title">${category.name}</h2>
                    </div>
                    <div class="product-grid">
                        ${itemsHTML}
                    </div>
                `;
                
                menuContainer.appendChild(section);
            });
            
            setupEventListeners();
            generateOrderStatusPanel();
            console.log('Menu generation completed');
        }

        // Helper function to get appropriate icon for each category
        function getCategoryIcon(categoryName) {
            const iconMap = {
                'Coffee': 'fas fa-coffee',
                'Non-Coffee': 'fas fa-glass-whiskey',
                'Tea': 'fas fa-leaf',
                'Signature Drinks': 'fas fa-star',
                'Appetizers': 'fas fa-drumstick-bite',
                'Burger & Sandwich': 'fas fa-hamburger',
                'Pasta': 'fas fa-utensils',
                'Desserts': 'fas fa-ice-cream',
                'Fruity Options': 'fas fa-apple-alt',
                'Signature Milkshakes': 'fas fa-cocktail'
            };
            
            return iconMap[categoryName] || 'fas fa-utensils';
        }

        // Setup all event listeners
        function setupEventListeners() {
            // Product click handlers - use direct event delegation
            document.addEventListener('click', function(e) {
                const productItem = e.target.closest('.product-item');
                
                if (productItem) {
                    // If clicked on product item
                    const productData = productItem.getAttribute('data-product');
                    if (productData) {
                        const product = JSON.parse(decodeURIComponent(productData));
                        openProductModal(product);
                    }
                }
                
                // Category tab clicks
                if (e.target.closest('.category-tab')) {
                    const tab = e.target.closest('.category-tab');
                    document.querySelectorAll('.category-tab').forEach(t => t.classList.remove('active'));
                    tab.classList.add('active');
                    
                    const categoryId = tab.dataset.category;
                    const targetSection = document.getElementById(categoryId);
                    if (targetSection) {
                        window.scrollTo({
                            top: targetSection.offsetTop - 120,
                            behavior: 'smooth'
                        });
                    }
                }
            });

            // Cart quantity adjustments
            document.addEventListener('click', (e) => {
                if (e.target.classList.contains('increase-quantity')) {
                    const index = e.target.dataset.index;
                    cart[index].quantity += 1;
                    updateCart();
                }
                
                if (e.target.classList.contains('decrease-quantity')) {
                    const index = e.target.dataset.index;
                    if (cart[index].quantity > 1) {
                        cart[index].quantity -= 1;
                    } else {
                        cart.splice(index, 1);
                    }
                    updateCart();
                }
                
                // Handle remove item button
                if (e.target.classList.contains('remove-item') || e.target.closest('.remove-item')) {
                    const button = e.target.classList.contains('remove-item') ? e.target : e.target.closest('.remove-item');
                    const index = button.dataset.index;
                    cart.splice(index, 1);
                    updateCart();
                }
                
                // Order actions
                if (e.target.classList.contains('cancel-btn')) {
                    const orderId = e.target.getAttribute('data-order-id');
                    cancelOrder(orderId);
                }
                
                if (e.target.classList.contains('reorder-btn')) {
                    const orderId = e.target.getAttribute('data-order-id');
                    reorder(orderId);
                }
            });
        }

        // Open product modal with details
        function openProductModal(product) {
            console.log('Opening modal for:', product.name);
            
            const modal = document.getElementById('product-modal');
            const modalImage = document.getElementById('modal-image');
            const modalTitle = document.getElementById('modal-title');
            const modalPrice = document.getElementById('modal-price');
            const modalDescription = document.getElementById('modal-description');
            const modalCustomization = document.getElementById('modal-customization');
            const modalAddToCart = document.getElementById('modal-add-to-cart');
            
            // Set basic product info
            modalImage.src = product.image;
            modalImage.alt = product.name;
            modalTitle.textContent = product.name;
            modalPrice.textContent = `â‚±${product.price}`;
            modalDescription.textContent = product.description;
            
            // Clear previous customizations
            modalCustomization.innerHTML = '';
            
            // Load menu data to get customizations
            const menuData = loadMenuData();
            
            // Get product category
            const productCategory = getProductCategory(product.id);
            
            // Get customizations that apply to this product's category
            const applicableCustomizations = menuData.customizations ? menuData.customizations.filter(custom => {
                // If no categories specified, apply to all categories
                if (!custom.categories || custom.categories.length === 0) {
                    return true;
                }
                
                // Check if this customization applies to the product's category
                return custom.categories.includes(productCategory);
            }) : [];
            
            // Add customizations if available
            if (applicableCustomizations.length > 0) {
                applicableCustomizations.forEach(custom => {
                    const group = document.createElement('div');
                    group.className = 'customization-group';
                    group.dataset.customizationId = custom.id;
                    
                    let optionsHTML = '';
                    
                    if (custom.type === 'single') {
                        // Radio buttons for single selection
                        custom.options.forEach((option, index) => {
                            const checked = index === 0 && custom.required ? 'checked' : '';
                            const priceDisplay = option.price > 0 ? `+â‚±${option.price}` : '+â‚±0';
                            
                            optionsHTML += `
                                <div class="option-item">
                                    <label class="option-label">
                                        <input type="radio" name="${custom.id}" value="${option.id}" ${checked} data-price="${option.price}">
                                        <span>${option.name}</span>
                                    </label>
                                    <span class="option-price">${priceDisplay}</span>
                                </div>
                            `;
                        });
                    } else if (custom.type === 'multiple') {
                        // For add-ons, use checkboxes with the same structure as customer.html
                        custom.options.forEach((option) => {
                            const priceDisplay = option.price > 0 ? `+â‚±${option.price}` : '+â‚±0';
                            
                            optionsHTML += `
                                <div class="addon-option" data-id="${option.id}" data-price="${option.price}">
                                    <div class="addon-info">
                                        <div class="addon-checkbox"></div>
                                        <span class="addon-name">${option.name}</span>
                                    </div>
                                    <span class="addon-price">${priceDisplay}</span>
                                </div>
                            `;
                        });
                    }
                    
                    const icon = custom.id === 'size' ? 'fas fa-glass' : 
                                custom.id === 'temperature' ? 'fas fa-thermometer-half' : 
                                custom.id === 'add-ons' ? 'fas fa-plus-circle' : 'fas fa-cog';
                    
                    group.innerHTML = `
                        <h4><i class="${icon}"></i> ${custom.name} ${custom.required ? '<span style="color: var(--danger-color);">*</span>' : ''}</h4>
                        <div class="option-list">
                            ${optionsHTML}
                        </div>
                    `;
                    
                    modalCustomization.appendChild(group);
                });
                
                // Set up event listeners for radio buttons to update total
                document.querySelectorAll('#modal-customization input[type="radio"]').forEach(radio => {
                    radio.addEventListener('change', function() {
                        updateModalTotal(product);
                    });
                });
                
                // Add event listeners for add-on options
                document.querySelectorAll('.addon-option').forEach(option => {
                    option.addEventListener('click', function() {
                        this.classList.toggle('selected');
                        updateModalTotal(product);
                    });
                });
                
                // Update total initially
                updateModalTotal(product);
            } else {
                modalCustomization.innerHTML = '<p style="text-align: center; color: #777;">No customization options available for this item.</p>';
            }
            
            // Set up add to cart button
            modalAddToCart.onclick = function() {
                addToCartFromModal(product);
            };
            
            // Show the modal with animation
            modal.style.display = 'flex';
            setTimeout(() => {
                modal.classList.add('open');
            }, 10);
            document.body.style.overflow = 'hidden';
        }

        // Update modal total price
        function updateModalTotal(product) {
            let total = product.price;
            
            // Calculate cost from all customization inputs
            const allInputs = document.querySelectorAll('#modal-customization input');
            
            // For radio buttons (single selection)
            const radioGroups = {};
            document.querySelectorAll('#modal-customization input[type="radio"]').forEach(radio => {
                const groupName = radio.name;
                if (radio.checked) {
                    radioGroups[groupName] = parseFloat(radio.dataset.price || 0);
                }
            });
            
            // Add radio button costs
            Object.values(radioGroups).forEach(price => {
                total += price;
            });
            
            // For checkboxes (add-ons)
            document.querySelectorAll('.addon-option.selected').forEach(addon => {
                total += parseFloat(addon.dataset.price || 0);
            });
            
            document.getElementById('modal-price').textContent = `â‚±${total.toFixed(2)}`;
            return total;
        }

        function addToCartFromModal(product) {
            const finalPrice = updateModalTotal(product);
            const customizations = {};
            
            // Get selected options for single choice customizations
            document.querySelectorAll('#modal-customization input[type="radio"]:checked').forEach(input => {
                const option = getCustomizationById(input.name)?.options.find(o => o.id === input.value);
                if (option) {
                    customizations[input.name] = option.name;
                }
            });
            
            // Get selected add-ons
            const selectedAddOns = [];
            document.querySelectorAll('.addon-option.selected').forEach(addon => {
                const addonId = addon.dataset.id;
                const addonPrice = parseFloat(addon.dataset.price) || 0;
                const addonName = addon.querySelector('.addon-name').textContent;
                
                selectedAddOns.push({
                    id: addonId,
                    name: addonName,
                    price: addonPrice
                });
            });
            
            if (selectedAddOns.length > 0) {
                customizations.addOns = selectedAddOns;
            }
            
            // Add to cart
            addToCart(product, customizations, finalPrice);
            closeProductModal();
            
            // Show success message
            showNotification(`${product.name} added to cart!`);
        }

        // Show notification
        function showNotification(message, type = 'success') {
            // Create notification element
            const notification = document.createElement('div');
            notification.textContent = message;
            notification.style.position = 'fixed';
            notification.style.top = '100px';
            notification.style.right = '20px';
            notification.style.background = type === 'success' ? 'var(--success-color)' : type === 'warning' ? 'var(--warning-color)' : 'var(--danger-color)';
            notification.style.color = 'white';
            notification.style.padding = '15px 20px';
            notification.style.borderRadius = '10px';
            notification.style.boxShadow = '0 5px 15px rgba(0,0,0,0.2)';
            notification.style.zIndex = '3000';
            notification.style.fontWeight = '600';
            notification.style.transition = 'all 0.3s ease';
            
            document.body.appendChild(notification);
            
            // Remove after 3 seconds
            setTimeout(() => {
                notification.style.opacity = '0';
                notification.style.transform = 'translateX(100%)';
                setTimeout(() => {
                    document.body.removeChild(notification);
                }, 300);
            }, 3000);
        }

        // Close product modal
        function closeProductModal() {
            const modal = document.getElementById('product-modal');
            modal.classList.remove('open');
            setTimeout(() => {
                modal.style.display = 'none';
            }, 300);
            document.body.style.overflow = 'auto';
        }

        // Cart functionality
        let cart = JSON.parse(localStorage.getItem('customerCart')) || [];
        const cartItems = document.getElementById('cart-items');
        const cartTotal = document.getElementById('cart-total');
        const checkoutBtn = document.getElementById('checkout-btn');
        const cartBadge = document.getElementById('cart-badge');

        // Initialize cart on load
        updateCart();

        // Update cart function
        function updateCart() {
            const totalItems = cart.reduce((total, item) => total + item.quantity, 0);
            const cartBadge = document.getElementById('cart-badge');
            if (cartBadge) cartBadge.textContent = totalItems;
            
            const cartItems = document.getElementById('cart-items');
            if (!cartItems) return;
            
            cartItems.innerHTML = '';
            
            if (cart.length === 0) {
                cartItems.innerHTML = '<div class="empty-cart-message">Your cart is empty</div>';
                updateCartTotalDisplay(0);
                document.getElementById('checkout-btn').disabled = true;
            } else {
                let baseTotal = 0;
                
                cart.forEach((item, index) => {
                    const itemDiv = document.createElement('div');
                    itemDiv.className = 'cart-item';
                    
                    let customizationString = '';
                    if (item.customizations) {
                        const customizations = [];
                        if (item.customizations.size) customizations.push(item.customizations.size);
                        if (item.customizations.temperature) customizations.push(item.customizations.temperature);
                        if (item.customizations.addOns && item.customizations.addOns.length > 0) {
                            item.customizations.addOns.forEach(addon => {
                                customizations.push(addon.name);
                            });
                        }
                        
                        if (customizations.length > 0) {
                            customizationString = ` (${customizations.join(', ')})`;
                        }
                    }
                    
                    const itemTotal = item.finalPrice * item.quantity;
                    baseTotal += itemTotal;
                    
                    itemDiv.innerHTML = `
                        <div class="cart-item-info">
                            <span class="cart-item-name">${item.name}${customizationString}</span>
                            <div style="display: flex; gap: 10px; align-items: center; margin-top: 5px;">
                                <span class="cart-item-price">â‚±${itemTotal.toFixed(2)}</span>
                                <span style="font-size: 0.8rem; color: #666;">${item.quantity}x â‚±${item.finalPrice.toFixed(2)}</span>
                            </div>
                        </div>
                        <div class="cart-item-actions">
                            <button class="decrease-quantity" data-index="${index}">-</button>
                            <input type="number" class="cart-item-quantity" value="${item.quantity}" min="1" data-index="${index}">
                            <button class="increase-quantity" data-index="${index}">+</button>
                            <button class="remove-item" data-index="${index}">
                                <i class="fas fa-trash"></i>
                            </button>
                        </div>
                    `;
                    
                    cartItems.appendChild(itemDiv);
                });
                
                updateCartTotalDisplay(baseTotal);
                document.getElementById('checkout-btn').disabled = false;
            }
            
            localStorage.setItem('customerCart', JSON.stringify(cart));
        }

        // Function to update cart total display
        function updateCartTotalDisplay(baseTotal) {
            const cartTotalElement = document.getElementById('cart-total');
            
            cartTotalElement.innerHTML = `
                <div style="text-align: right;">
                    <div style="display: flex; justify-content: space-between; padding-top: 10px;">
                        <span style="font-size: 1.3rem; font-weight: 700;">Total:</span>
                        <span style="font-size: 1.3rem; font-weight: 700; color: var(--primary-color);">â‚±${baseTotal.toFixed(2)}</span>
                    </div>
                </div>
            `;
        }

        function addToCart(product, customizations = {}, finalPrice = null) {
            // If finalPrice is not provided, use the base price
            if (finalPrice === null) {
                finalPrice = product.price;
            }
            
            // Check for existing item with the same name and same customizations
            const existingItemIndex = cart.findIndex(item => 
                item.name === product.name && 
                JSON.stringify(item.customizations) === JSON.stringify(customizations)
            );
            
            if (existingItemIndex !== -1) {
                cart[existingItemIndex].quantity += 1;
            } else {
                cart.push({
                    name: product.name,
                    basePrice: product.price,
                    finalPrice: finalPrice,
                    customizations: customizations,
                    quantity: 1
                });
            }
            
            updateCart();
        }

        // Cart Panel Functionality
        const cartIcon = document.getElementById('cart-icon');
        const cartPanel = document.getElementById('cart-panel');
        const closeCart = document.getElementById('close-cart');
        const cartOverlay = document.getElementById('cart-overlay');

        cartIcon.addEventListener('click', openCart);
        closeCart.addEventListener('click', closeCartPanel);
        cartOverlay.addEventListener('click', closeCartPanel);

        function openCart() {
            cartPanel.classList.add('open');
            cartOverlay.classList.add('open');
            document.body.style.overflow = 'hidden';
        }

        function closeCartPanel() {
            cartPanel.classList.remove('open');
            cartOverlay.classList.remove('open');
            document.body.style.overflow = 'auto';
        }

        // Close modal functionality
        const closeModal = document.getElementById('close-modal');
        closeModal.addEventListener('click', closeProductModal);

        // Close modal when clicking outside
        document.getElementById('product-modal').addEventListener('click', (e) => {
            if (e.target === document.getElementById('product-modal')) {
                closeProductModal();
            }
        });

        // Handle direct input changes in cart
        document.addEventListener('change', (e) => {
            if (e.target.classList.contains('cart-item-quantity')) {
                const index = e.target.dataset.index;
                const newQuantity = parseInt(e.target.value);
                
                if (newQuantity < 1) {
                    cart.splice(index, 1);
                } else {
                    cart[index].quantity = newQuantity;
                }
                
                updateCart();
            }
        });

        // Checkout function - now opens checkout modal
        checkoutBtn.addEventListener('click', () => {
            if (cart.length === 0) {
                showNotification('Your cart is empty! Add items to proceed.', 'warning');
                return;
            }
            
            // Open checkout modal
            openCheckoutModal();
        });

        // Category navigation highlighting on scroll
        window.addEventListener('scroll', () => {
            const categoryTabs = document.querySelectorAll('.category-tab');
            const sections = document.querySelectorAll('.menu-category-section');
            
            let current = '';
            
            sections.forEach(section => {
                const sectionTop = section.offsetTop;
                if (window.scrollY >= (sectionTop - 150)) {
                    current = section.getAttribute('id');
                }
            });
            
            categoryTabs.forEach(tab => {
                tab.classList.remove('active');
                if (tab.dataset.category === current) {
                    tab.classList.add('active');
                }
            });
        });

        // Order Status Panel Functionality
        const orderStatusIcon = document.getElementById('order-status-icon');
        const orderStatusPanel = document.getElementById('order-status-panel');
        const closeOrderStatus = document.getElementById('close-order-status');
        const orderStatusOverlay = document.getElementById('order-status-overlay');
        const orderStatusContent = document.getElementById('order-status-content');

        // Add event listeners for order status panel
        if (orderStatusIcon && orderStatusPanel && closeOrderStatus && orderStatusOverlay) {
            orderStatusIcon.addEventListener('click', openOrderStatus);
            closeOrderStatus.addEventListener('click', closeOrderStatusPanel);
            orderStatusOverlay.addEventListener('click', closeOrderStatusPanel);
        }

        // Open order status panel
        function openOrderStatus() {
            console.log('Opening order status panel');
            
            // Refresh order status panel content
            generateOrderStatusPanel();
            
            // Show the panel
            orderStatusPanel.classList.add('open');
            orderStatusOverlay.classList.add('open');
            document.body.style.overflow = 'hidden';
        }

        // Initialize order status
        function initializeOrderStatus() {
            // Update orders badge on load
            updateOrdersBadge();
            
            // Add event listeners for order status panel
            if (orderStatusIcon) {
                orderStatusIcon.addEventListener('click', openOrderStatus);
            }
            
            if (closeOrderStatus) {
                closeOrderStatus.addEventListener('click', closeOrderStatusPanel);
            }
            
            if (orderStatusOverlay) {
                orderStatusOverlay.addEventListener('click', closeOrderStatusPanel);
            }
        }

        // Close order status panel
        function closeOrderStatusPanel() {
            console.log('Closing order status panel');
            orderStatusPanel.classList.remove('open');
            orderStatusOverlay.classList.remove('open');
            document.body.style.overflow = 'auto';
        }

        // Generate order cards for the panel
        function generateOrderStatusPanel() {
            console.log('Generating order status panel');
            
            const orders = getUserOrders();
            
            // Clear existing content
            if (orderStatusContent) {
                orderStatusContent.innerHTML = '';
            } else {
                console.error('Order status content element not found');
                return;
            }
            
            // Separate active orders from history
            const activeOrders = orders.filter(order => 
                order.status !== 'Completed' && order.status !== 'Cancelled'
            );
            
            const historyOrders = orders.filter(order => 
                order.status === 'Completed' || order.status === 'Cancelled'
            );
            
            // Display message if no orders
            if (activeOrders.length === 0 && historyOrders.length === 0) {
                orderStatusContent.innerHTML = `
                    <div class="empty-state">
                        <i class="fas fa-clipboard-list"></i>
                        <h3>No Orders Yet</h3>
                        <p>Your orders will appear here once you place them.</p>
                        <button id="start-shopping-btn" style="
                            margin-top: 15px;
                            padding: 10px 20px;
                            background: var(--primary-color);
                            color: white;
                            border: none;
                            border-radius: 8px;
                            cursor: pointer;
                            font-weight: 600;
                        ">
                            <i class="fas fa-shopping-bag"></i> Start Shopping
                        </button>
                    </div>
                `;
                
                // Add event listener for start shopping button
                setTimeout(() => {
                    const startShoppingBtn = document.getElementById('start-shopping-btn');
                    if (startShoppingBtn) {
                        startShoppingBtn.addEventListener('click', () => {
                            closeOrderStatusPanel();
                            window.scrollTo({ top: 0, behavior: 'smooth' });
                        });
                    }
                }, 100);
            } else {
                // Display active orders
                if (activeOrders.length > 0) {
                    const activeSection = document.createElement('div');
                    activeSection.innerHTML = `<h4 style="margin-bottom: 15px; color: var(--primary-color); font-size: 1.1rem;">Active Orders (${activeOrders.length})</h4>`;
                    orderStatusContent.appendChild(activeSection);
                    
                    activeOrders.sort((a, b) => new Date(b.timestamp) - new Date(a.timestamp))
                        .forEach(order => {
                            const orderCard = createOrderCard(order);
                            orderStatusContent.appendChild(orderCard);
                        });
                }
                
                // Display order history
                if (historyOrders.length > 0) {
                    const historySection = document.createElement('div');
                    historySection.innerHTML = `<h4 style="margin: 20px 0 15px; color: var(--primary-color); font-size: 1.1rem;">Order History (${historyOrders.length})</h4>`;
                    orderStatusContent.appendChild(historySection);
                    
                    historyOrders.sort((a, b) => new Date(b.timestamp) - new Date(a.timestamp))
                        .forEach(order => {
                            const orderCard = createOrderCard(order);
                            orderStatusContent.appendChild(orderCard);
                        });
                }
            }
            
            // Update orders badge
            updateOrdersBadge();
        }

        // Create an order card for the panel
        function createOrderCard(order) {
            const orderCard = document.createElement('div');
            orderCard.className = 'order-card';
            orderCard.dataset.orderId = order.id;
            
            // Format date
            const orderDate = new Date(order.timestamp);
            const formattedDate = orderDate.toLocaleDateString('en-US', {
                month: 'short',
                day: 'numeric',
                hour: '2-digit',
                minute: '2-digit'
            });
            
            // Calculate estimated completion time
            const estimatedTime = calculateEstimatedTime(order.status, order.timestamp);
            
            // Create status timeline
            const statusTimeline = createStatusTimeline(order.status);
            
            // Create progress bar
            const progressBar = createProgressBar(order.status);
            
            // Build items list HTML
            let itemsHTML = '';
            const orderItems = order.items || [];
            
            orderItems.forEach((item, index) => {
                let customizationString = '';
                
                if (item.customizations) {
                    const customizations = [];
                    
                    if (item.customizations.temperature) customizations.push(item.customizations.temperature);
                    if (item.customizations.size) customizations.push(item.customizations.size);
                    
                    // Handle add-ons from new order structure
                    if (item.customizations.addOns && item.customizations.addOns.length > 0) {
                        item.customizations.addOns.forEach(addon => {
                            if (typeof addon === 'object' && addon.name) {
                                customizations.push(addon.name);
                            } else if (typeof addon === 'string') {
                                customizations.push(addon);
                            }
                        });
                    }
                    
                    // Handle old order structure
                    if (item.customizations.add_ons && item.customizations.add_ons.length > 0) {
                        item.customizations.add_ons.forEach(addon => {
                            if (typeof addon === 'string') {
                                customizations.push(addon);
                            }
                        });
                    }
                    
                    if (item.customizations.other_beverage) customizations.push(item.customizations.other_beverage);
                    if (item.customizations.alcoholic_beverage) customizations.push(item.customizations.alcoholic_beverage);
                    
                    if (customizations.length > 0) {
                        customizationString = ` (${customizations.join(', ')})`;
                    }
                }
                
                const itemPrice = item.finalPrice || item.price || 0;
                const itemQuantity = item.quantity || 1;
                const itemTotal = (itemPrice * itemQuantity).toFixed(2);
                
                itemsHTML += `
                    <div class="order-item">
                        <div class="item-details">
                            <span class="item-name">${item.name}${customizationString}</span>
                            <span class="item-quantity">x${itemQuantity}</span>
                        </div>
                        <span class="item-price">â‚±${itemTotal}</span>
                    </div>
                `;
            });
            
            // Calculate total
            const orderTotal = order.total || order.totalPrice || order.baseTotal || 0;

            const deliveryType = order.delivery && order.delivery.type ? order.delivery.type : null;
            const deliveryTitle = deliveryType === 'delivery' ? 'Delivery' : (deliveryType === 'pickup' ? 'Pickup' : 'Order Type');
            let deliveryInfoHTML = '';
            if (deliveryType === 'delivery') {
                const addr = order.delivery.address || '';
                const instr = order.delivery.instructions || '';
                const fee = typeof order.delivery.fee === 'number' ? order.delivery.fee : 0;
                deliveryInfoHTML = `
                    <div class="order-delivery">
                        <div class="order-delivery-title">${deliveryTitle}</div>
                        <div>Address: ${addr || 'N/A'}</div>
                        ${instr ? `<div>Instructions: ${instr}</div>` : ''}
                        ${fee ? `<div>Delivery Fee: â‚±${fee.toFixed(2)}</div>` : ''}
                    </div>
                `;
            } else if (deliveryType === 'pickup') {
                const pickupTime = order.delivery.pickupTime || '';
                deliveryInfoHTML = `
                    <div class="order-delivery">
                        <div class="order-delivery-title">${deliveryTitle}</div>
                        ${pickupTime ? `<div>Pickup Time: ${pickupTime}</div>` : ''}
                    </div>
                `;
            }
            
            // Determine which actions to show
            let actionsHTML = '';
            if (order.status === 'New' || order.status === 'Preparing') {
                actionsHTML = `
                    <button class="action-btn cancel-btn" data-order-id="${order.id}">
                        <i class="fas fa-times"></i> Cancel Order
                    </button>
                `;
            } else if (order.status === 'Completed' || order.status === 'Cancelled') {
                actionsHTML = `
                    <button class="action-btn reorder-btn" data-order-id="${order.id}">
                        <i class="fas fa-redo"></i> Reorder
                    </button>
                `;
            }
            
            // Determine status class
            let statusClass = '';
            switch(order.status.toLowerCase()) {
                case 'new':
                    statusClass = 'status-new';
                    break;
                case 'preparing':
                    statusClass = 'status-preparing';
                    break;
                case 'ready':
                    statusClass = 'status-ready';
                    break;
                case 'completed':
                    statusClass = 'status-completed';
                    break;
                case 'cancelled':
                    statusClass = 'status-cancelled';
                    break;
                default:
                    statusClass = 'status-new';
            }
            
            orderCard.innerHTML = `
                <div class="order-header">
                    <div>
                        <div class="order-id">Order #${order.id}</div>
                        <div class="order-date">${formattedDate}</div>
                    </div>
                    <div class="order-status ${statusClass}">${order.status}</div>
                </div>
                
                <div class="order-details">
                    <div class="order-items">
                        ${itemsHTML || '<p style="color: #777; font-style: italic;">No items in this order</p>'}
                    </div>
                    ${deliveryInfoHTML || ''}
                    <div class="order-total">
                        <span>Total</span>
                        <span>â‚±${parseFloat(orderTotal).toFixed(2)}</span>
                    </div>
                </div>
                
                ${order.status !== 'Completed' && order.status !== 'Cancelled' ? `
                    <div class="order-progress">
                        ${progressBar}
                        <div class="progress-labels">
                            <span>Order Placed</span>
                            <span>Estimated: ${estimatedTime}</span>
                        </div>
                    </div>
                    ${statusTimeline}
                ` : ''}
                
                ${actionsHTML ? `<div class="order-actions">${actionsHTML}</div>` : ''}
            `;
            
            // Add event listeners for action buttons
            setTimeout(() => {
                const cancelBtn = orderCard.querySelector('.cancel-btn');
                const reorderBtn = orderCard.querySelector('.reorder-btn');
                
                if (cancelBtn) {
                    cancelBtn.addEventListener('click', function() {
                        const orderId = this.getAttribute('data-order-id');
                        cancelOrder(orderId);
                    });
                }
                
                if (reorderBtn) {
                    reorderBtn.addEventListener('click', function() {
                        const orderId = this.getAttribute('data-order-id');
                        reorder(orderId);
                    });
                }
            }, 100);
            
            return orderCard;
        }

        // Calculate estimated completion time
        function calculateEstimatedTime(status, orderTimestamp) {
            const orderTime = new Date(orderTimestamp);
            let estimatedMinutes = 0;
            
            switch(status.toLowerCase()) {
                case 'new':
                    estimatedMinutes = 20;
                    break;
                case 'preparing':
                    estimatedMinutes = 10;
                    break;
                case 'ready':
                    estimatedMinutes = 5;
                    break;
                case 'completed':
                    estimatedMinutes = 0;
                    break;
                default:
                    estimatedMinutes = 20;
            }
            
            if (estimatedMinutes === 0) return 'Ready';
            
            const estimatedTime = new Date(orderTime.getTime() + estimatedMinutes * 60000);
            return estimatedTime.toLocaleTimeString('en-US', {
                hour: '2-digit',
                minute: '2-digit'
            });
        }

        // Create status timeline
        function createStatusTimeline(status) {
            const steps = [
                { id: 'new', label: 'Order Placed', icon: 'fas fa-shopping-cart' },
                { id: 'preparing', label: 'Preparing', icon: 'fas fa-utensils' },
                { id: 'ready', label: 'Ready', icon: 'fas fa-check-circle' },
                { id: 'completed', label: 'Completed', icon: 'fas fa-flag-checkered' }
            ];
            
            let timelineHTML = '<div class="status-timeline">';
            
            steps.forEach(step => {
                let stepClass = '';
                let stepIcon = step.icon;
                
                const statusLower = status.toLowerCase();
                
                if (statusLower === 'new') {
                    if (step.id === 'new') stepClass = 'active';
                } else if (statusLower === 'preparing') {
                    if (step.id === 'new') stepClass = 'completed';
                    else if (step.id === 'preparing') stepClass = 'active';
                } else if (statusLower === 'ready') {
                    if (step.id === 'new' || step.id === 'preparing') stepClass = 'completed';
                    else if (step.id === 'ready') stepClass = 'active';
                } else if (statusLower === 'completed') {
                    stepClass = 'completed';
                } else if (statusLower === 'cancelled') {
                    // For cancelled orders, show no active steps
                    stepClass = '';
                }
                
                timelineHTML += `
                    <div class="status-step ${stepClass}">
                        <div class="status-indicator">
                            <i class="${stepIcon}"></i>
                        </div>
                        <div class="status-label">${step.label}</div>
                    </div>
                `;
            });
            
            timelineHTML += '</div>';
            return timelineHTML;
        }

        // Create progress bar
        function createProgressBar(status) {
            let progress = 0;
            
            switch(status.toLowerCase()) {
                case 'new':
                    progress = 25;
                    break;
                case 'preparing':
                    progress = 50;
                    break;
                case 'ready':
                    progress = 75;
                    break;
                case 'completed':
                    progress = 100;
                    break;
                default:
                    progress = 0;
            }
            
            return `
                <div class="progress-bar">
                    <div class="progress-fill" style="width: ${progress}%"></div>
                </div>
            `;
        }

        // Cancel order function
        function cancelOrder(orderId) {
            const orders = loadOrders();
            const orderIndex = orders.findIndex(order => order.id == orderId);
            
            if (orderIndex !== -1) {
                // Check if order can be cancelled (only New or Preparing orders)
                const order = orders[orderIndex];
                const status = order.status.toLowerCase();
                
                if (status === 'new' || status === 'preparing') {
                    if (confirm('Are you sure you want to cancel this order?')) {
                        orders[orderIndex].status = 'Cancelled';
                        localStorage.setItem('bistroOrders', JSON.stringify(orders));
                        
                        // Refresh order status panel
                        generateOrderStatusPanel();
                        
                        // Show notification
                        showNotification(`Order #${orderId} has been cancelled successfully.`);
                    }
                } else {
                    alert('This order cannot be cancelled at this stage.');
                }
            } else {
                alert('Order not found.');
            }
        }

        // Reorder function
        function reorder(orderId) {
            const orders = loadOrders();
            const order = orders.find(order => order.id == orderId);
            
            if (order) {
                // Add items to cart
                const cart = JSON.parse(localStorage.getItem('customerCart')) || [];
                const orderItems = order.items || [];
                
                let addedItems = 0;
                
                orderItems.forEach(item => {
                    // Check if item already exists in cart with same customizations
                    const existingItemIndex = cart.findIndex(cartItem => 
                        cartItem.name === item.name && 
                        JSON.stringify(cartItem.customizations) === JSON.stringify(item.customizations)
                    );
                    
                    if (existingItemIndex !== -1) {
                        // Increase quantity if item exists with same customizations
                        cart[existingItemIndex].quantity += (item.quantity || 1);
                        addedItems++;
                    } else {
                        // Add new item with customizations
                        cart.push({
                            name: item.name,
                            basePrice: item.basePrice || item.finalPrice || item.price || 0,
                            finalPrice: item.finalPrice || item.price || 0,
                            customizations: item.customizations || {},
                            quantity: item.quantity || 1
                        });
                        addedItems++;
                    }
                });
                
                localStorage.setItem('customerCart', JSON.stringify(cart));
                updateCart();
                
                // Close order status panel and open cart
                closeOrderStatusPanel();
                openCart();
                
                // Show notification
                showNotification(`${addedItems} item(s) added to cart from Order #${orderId}`);
            } else {
                alert('Order not found.');
            }
        }

        // User dropdown toggle
        const userIcon = document.getElementById('user-icon');
        const userDropdownMenu = document.getElementById('user-dropdown-menu');
        userIcon.addEventListener('click', () => {
            userDropdownMenu.style.display = userDropdownMenu.style.display === 'block' ? 'none' : 'block';
        });

        // Close dropdown when clicking outside
        document.addEventListener('click', (e) => {
            if (!userIcon.contains(e.target) && !userDropdownMenu.contains(e.target)) {
                userDropdownMenu.style.display = 'none';
            }
        });

        // Update welcome message based on logged-in user
        const loggedInUser = JSON.parse(localStorage.getItem('bistroLoggedInUser'));
        const welcomeMessage = document.getElementById('welcome-message');
        if (loggedInUser && loggedInUser.name) {
            welcomeMessage.textContent = `Welcome, ${loggedInUser.name}!`;
        }

        // ============================================
        // CHECKOUT MODAL FUNCTIONALITY
        // ============================================

        // DOM Elements
        const checkoutModal = document.getElementById('checkout-modal');
        const closeCheckout = document.getElementById('close-checkout');
        const checkoutOverlay = document.getElementById('checkout-overlay');
        const confirmOrderBtn = document.getElementById('confirm-order-btn');

        // Open checkout modal when checkout button is clicked
        function openCheckoutModal() {
            if (cart.length === 0) {
                showNotification('Your cart is empty! Add items to proceed.', 'warning');
                return;
            }
            
            closeCartPanel(); // Close cart panel if open
            
            // Update checkout modal with current cart items
            updateCheckoutItems();
            
            // Set customer info if logged in
            const loggedInUser = JSON.parse(localStorage.getItem('bistroLoggedInUser'));
            if (loggedInUser && loggedInUser.name) {
                document.getElementById('customer-name').value = loggedInUser.name || '';
                document.getElementById('pickup-name').value = loggedInUser.name || '';
                
                // Try to get saved address if exists
                const savedAddress = localStorage.getItem(`bistroAddress_${loggedInUser.name}`);
                if (savedAddress) {
                    document.getElementById('customer-address').value = savedAddress;
                }
                
                // Try to get saved phone if exists
                const savedPhone = localStorage.getItem(`bistroPhone_${loggedInUser.name}`);
                if (savedPhone) {
                    document.getElementById('customer-phone').value = savedPhone;
                }
            }
            
            // Show modal
            checkoutModal.classList.add('open');
            checkoutOverlay.classList.add('open');
            document.body.style.overflow = 'hidden';
        }

        function closeCheckoutModal() {
            checkoutModal.classList.remove('open');
            checkoutOverlay.classList.remove('open');
            document.body.style.overflow = 'auto';
        }

        // Close checkout modal
        closeCheckout.addEventListener('click', closeCheckoutModal);
        checkoutOverlay.addEventListener('click', closeCheckoutModal);

        function updateCheckoutItems() {
            const checkoutItemsContainer = document.getElementById('checkout-items');
            const checkoutSubtotal = document.getElementById('checkout-subtotal');
            const checkoutTotal = document.getElementById('checkout-total');
            const confirmTotal = document.getElementById('confirm-total');
            
            let itemsHTML = '';
            let subtotal = 0;
            
            cart.forEach((item, index) => {
                let customizationString = '';
                if (item.customizations) {
                    const customizations = [];
                    if (item.customizations.size) customizations.push(item.customizations.size);
                    if (item.customizations.temperature) customizations.push(item.customizations.temperature);
                    if (item.customizations.addOns && item.customizations.addOns.length > 0) {
                        item.customizations.addOns.forEach(addon => {
                            customizations.push(addon.name);
                        });
                    }
                    
                    if (customizations.length > 0) {
                        customizationString = customizations.join(', ');
                    }
                }
                
                const itemTotal = item.finalPrice * item.quantity;
                subtotal += itemTotal;
                
                itemsHTML += `
                    <div class="checkout-item">
                        <div class="item-details">
                            <span class="item-name">${item.name} Ã— ${item.quantity}</span>
                            ${customizationString ? `<span class="item-customization">${customizationString}</span>` : ''}
                        </div>
                        <span class="item-price">â‚±${itemTotal.toFixed(2)}</span>
                    </div>
                `;
            });
            
            checkoutItemsContainer.innerHTML = itemsHTML;
            
            const deliveryType = document.querySelector('.delivery-option.active').dataset.type;
            const deliveryFee = deliveryType === 'delivery' ? 50.00 : 0.00;
            const total = subtotal + deliveryFee;
            
            checkoutSubtotal.textContent = `â‚±${subtotal.toFixed(2)}`;
            document.getElementById('delivery-fee').textContent = `â‚±${deliveryFee.toFixed(2)}`;
            checkoutTotal.textContent = `â‚±${total.toFixed(2)}`;
            confirmTotal.textContent = total.toFixed(2);
        }

        // Delivery type selection
        document.querySelectorAll('.delivery-option').forEach(option => {
            option.addEventListener('click', function() {
                document.querySelectorAll('.delivery-option').forEach(opt => opt.classList.remove('active'));
                this.classList.add('active');
                
                const deliveryType = this.dataset.type;
                document.getElementById('selected-delivery-type').textContent = 
                    deliveryType === 'delivery' ? 'Delivery' : 'Pickup';
                
                if (deliveryType === 'delivery') {
                    document.getElementById('delivery-form').style.display = 'block';
                    document.getElementById('pickup-form').style.display = 'none';
                    
                    // Update delivery fee
                    document.getElementById('delivery-fee').textContent = 'â‚±50.00';
                } else {
                    document.getElementById('delivery-form').style.display = 'none';
                    document.getElementById('pickup-form').style.display = 'block';
                    
                    // Remove delivery fee for pickup
                    document.getElementById('delivery-fee').textContent = 'â‚±0.00';
                }
                
                // Update totals
                updateCheckoutTotal();
            });
        });

        // Payment method selection
        document.querySelectorAll('.payment-option').forEach(option => {
            option.addEventListener('click', function() {
                document.querySelectorAll('.payment-option').forEach(opt => opt.classList.remove('active'));
                this.classList.add('active');
                
                const paymentMethod = this.dataset.method;
                document.getElementById('selected-payment-method').textContent = 
                    getPaymentMethodName(paymentMethod);
                
                // Show corresponding payment details
                document.querySelectorAll('.payment-details').forEach(detail => detail.style.display = 'none');
                document.getElementById(`${paymentMethod}-details`).style.display = 'block';
            });
        });

        function getPaymentMethodName(method) {
            const methods = {
                'cash': 'Cash on Delivery',
                'gcash': 'GCash',
                'maya': 'Maya',
                'card': 'Credit/Debit Card'
            };
            return methods[method] || method;
        }

        // Pickup time selection
        const pickupTimeSelect = document.getElementById('pickup-time');
        const specificTimeGroup = document.getElementById('specific-time-group');
        const specificTimeInput = document.getElementById('specific-time');

        if (pickupTimeSelect) {
            pickupTimeSelect.addEventListener('change', function() {
                if (this.value === 'specific') {
                    specificTimeGroup.style.display = 'block';
                    
                    // Set minimum time to now
                    const now = new Date();
                    const year = now.getFullYear();
                    const month = String(now.getMonth() + 1).padStart(2, '0');
                    const day = String(now.getDate()).padStart(2, '0');
                    const hours = String(now.getHours()).padStart(2, '0');
                    const minutes = String(now.getMinutes()).padStart(2, '0');
                    
                    specificTimeInput.min = `${year}-${month}-${day}T${hours}:${minutes}`;
                    
                    // Set default to 1 hour from now
                    now.setHours(now.getHours() + 1);
                    const defaultYear = now.getFullYear();
                    const defaultMonth = String(now.getMonth() + 1).padStart(2, '0');
                    const defaultDay = String(now.getDate()).padStart(2, '0');
                    const defaultHours = String(now.getHours()).padStart(2, '0');
                    const defaultMinutes = String(now.getMinutes()).padStart(2, '0');
                    
                    specificTimeInput.value = `${defaultYear}-${defaultMonth}-${defaultDay}T${defaultHours}:${defaultMinutes}`;
                } else {
                    specificTimeGroup.style.display = 'none';
                }
            });
        }

        // Update checkout total when delivery type changes
        function updateCheckoutTotal() {
            const subtotalText = document.getElementById('checkout-subtotal').textContent;
            const subtotal = parseFloat(subtotalText.replace('â‚±', '').replace(',', ''));
            
            const deliveryFeeText = document.getElementById('delivery-fee').textContent;
            const deliveryFee = parseFloat(deliveryFeeText.replace('â‚±', '').replace(',', ''));
            
            const total = subtotal + deliveryFee;
            
            document.getElementById('checkout-total').textContent = `â‚±${total.toFixed(2)}`;
            document.getElementById('confirm-total').textContent = total.toFixed(2);
        }

        // Place order function
        if (confirmOrderBtn) {
            confirmOrderBtn.addEventListener('click', function() {
                if (!validateCheckoutForm()) {
                    return;
                }
                
                // Get delivery type
                const deliveryType = document.querySelector('.delivery-option.active').dataset.type;
                const isDelivery = deliveryType === 'delivery';
                
                // Get payment method
                const paymentMethod = document.querySelector('.payment-option.active').dataset.method;
                
                // Get customer information
                const customerName = isDelivery ? 
                    document.getElementById('customer-name').value.trim() : 
                    document.getElementById('pickup-name').value.trim();
                
                const customerPhone = document.getElementById('customer-phone').value.trim();
                
                let deliveryInfo = {};
                if (isDelivery) {
                    deliveryInfo = {
                        type: 'delivery',
                        address: document.getElementById('customer-address').value.trim(),
                        instructions: document.getElementById('delivery-instructions').value.trim(),
                        fee: 50.00
                    };
                    
                    // Save address for future use
                    const loggedInUser = JSON.parse(localStorage.getItem('bistroLoggedInUser'));
                    if (loggedInUser && loggedInUser.name) {
                        localStorage.setItem(`bistroAddress_${loggedInUser.name}`, deliveryInfo.address);
                        localStorage.setItem(`bistroPhone_${loggedInUser.name}`, customerPhone);
                    }
                } else {
                    const pickupTime = document.getElementById('pickup-time').value;
                    let pickupDateTime = '';
                    
                    if (pickupTime === 'asap') {
                        const now = new Date();
                        now.setMinutes(now.getMinutes() + 20); // 20 minutes for ASAP
                        pickupDateTime = now.toLocaleString();
                    } else if (pickupTime === '30min') {
                        const now = new Date();
                        now.setMinutes(now.getMinutes() + 30);
                        pickupDateTime = now.toLocaleString();
                    } else if (pickupTime === '1hour') {
                        const now = new Date();
                        now.setHours(now.getHours() + 1);
                        pickupDateTime = now.toLocaleString();
                    } else if (pickupTime === 'specific') {
                        const specificTime = document.getElementById('specific-time').value;
                        if (specificTime) {
                            pickupDateTime = new Date(specificTime).toLocaleString();
                        } else {
                            const now = new Date();
                            now.setMinutes(now.getMinutes() + 20);
                            pickupDateTime = now.toLocaleString();
                        }
                    }
                    
                    deliveryInfo = {
                        type: 'pickup',
                        storeName: 'Coffee Affair Bistro',
                        storeAddress: '123 Coffee Street, Makati City, Metro Manila',
                        pickupTime: pickupDateTime,
                        fee: 0.00
                    };
                }
                
                // Get payment details
                let paymentDetails = {
                    method: paymentMethod,
                    status: paymentMethod === 'cash' ? 'pending' : 'paid'
                };
                
                if (paymentMethod === 'gcash') {
                    paymentDetails.reference = document.getElementById('gcash-reference').value.trim();
                } else if (paymentMethod === 'maya') {
                    paymentDetails.reference = document.getElementById('maya-reference').value.trim();
                } else if (paymentMethod === 'card') {
                    paymentDetails.cardLast4 = document.getElementById('card-number').value.trim().slice(-4);
                }
                
                // Calculate totals
                const subtotal = cart.reduce((total, item) => total + (item.finalPrice * item.quantity), 0);
                const deliveryFee = deliveryInfo.fee || 0;
                const total = subtotal + deliveryFee;
                
                // Create order object
                const order = {
                    id: 'ORD-' + Date.now().toString().slice(-8),
                    customerName: customerName,
                    customerPhone: customerPhone,
                    items: JSON.parse(JSON.stringify(cart)),
                    delivery: deliveryInfo,
                    payment: paymentDetails,
                    subtotal: subtotal,
                    deliveryFee: deliveryFee,
                    total: total,
                    status: 'New',
                    timestamp: new Date().toISOString(),
                    estimatedTime: calculateOrderTime(deliveryInfo.type)
                };
                
                // Save order
                saveOrder(order);
                
                // Clear cart
                cart = [];
                updateCart();
                
                // Close checkout modal
                closeCheckoutModal();
                
                // Show order confirmation
                showOrderConfirmation(order);
            });
        }

        function validateCheckoutForm() {
            const deliveryType = document.querySelector('.delivery-option.active').dataset.type;
            const isDelivery = deliveryType === 'delivery';
            
            // Validate name
            const nameField = isDelivery ? 'customer-name' : 'pickup-name';
            const nameInput = document.getElementById(nameField);
            const name = nameInput.value.trim();
            if (!name) {
                showNotification('Please enter your name', 'warning');
                nameInput.focus();
                return false;
            }
            
            // Validate phone
            const phoneInput = document.getElementById('customer-phone');
            const phone = phoneInput.value.trim();
            if (!phone) {
                showNotification('Please enter your phone number', 'warning');
                phoneInput.focus();
                return false;
            }
            
            // Validate phone format (Philippines)
            const phoneRegex = /^(09|\+639)\d{9}$/;
            const cleanedPhone = phone.replace(/\D/g, '');
            if (!phoneRegex.test(cleanedPhone)) {
                showNotification('Please enter a valid Philippine phone number (09XXXXXXXXX)', 'warning');
                phoneInput.focus();
                return false;
            }
            
            // Validate address for delivery
            if (isDelivery) {
                const addressInput = document.getElementById('customer-address');
                const address = addressInput.value.trim();
                if (!address) {
                    showNotification('Please enter your delivery address', 'warning');
                    addressInput.focus();
                    return false;
                }
                
                if (address.length < 10) {
                    showNotification('Please enter a complete address (at least 10 characters)', 'warning');
                    addressInput.focus();
                    return false;
                }
            }
            
            // Validate pickup time if specific time selected
            if (!isDelivery && document.getElementById('pickup-time').value === 'specific') {
                const specificTimeInput = document.getElementById('specific-time');
                const specificTime = specificTimeInput.value;
                if (!specificTime) {
                    showNotification('Please select a specific pickup time', 'warning');
                    specificTimeInput.focus();
                    return false;
                }
                
                const selectedTime = new Date(specificTime);
                const now = new Date();
                if (selectedTime < now) {
                    showNotification('Please select a future time for pickup', 'warning');
                    specificTimeInput.focus();
                    return false;
                }
            }
            
            return true;
        }

        function calculateOrderTime(deliveryType) {
            const now = new Date();
            if (deliveryType === 'pickup') {
                now.setMinutes(now.getMinutes() + 20); // 20 minutes for pickup
            } else {
                now.setMinutes(now.getMinutes() + 40); // 40 minutes for delivery
            }
            return now.toISOString();
        }

        function saveOrder(order) {
            const orders = JSON.parse(localStorage.getItem('bistroOrders')) || [];
            orders.push(order);
            localStorage.setItem('bistroOrders', JSON.stringify(orders));
            
            // Update order badge
            updateOrdersBadge();
            
            // Show success notification
            showNotification(`Order #${order.id} placed successfully!`, 'success');
        }

        function showOrderConfirmation(order) {
            const isDelivery = order.delivery.type === 'delivery';
            
            let confirmationHTML = `
                <div id="order-confirmation-modal" style="
                    position: fixed;
                    top: 0;
                    left: 0;
                    right: 0;
                    bottom: 0;
                    background: rgba(0, 0, 0, 0.9);
                    z-index: 3000;
                    display: flex;
                    align-items: center;
                    justify-content: center;
                    padding: 20px;
                    backdrop-filter: blur(5px);
                ">
                    <div style="
                        background: white;
                        border-radius: 20px;
                        padding: 30px;
                        max-width: 500px;
                        width: 100%;
                        box-shadow: 0 20px 40px rgba(0,0,0,0.4);
                        border: 3px solid var(--success-color);
                    ">
                        <div style="text-align: center; margin-bottom: 25px;">
                            <div style="font-size: 3rem; color: var(--success-color); margin-bottom: 10px;">
                                <i class="fas fa-check-circle"></i>
                            </div>
                            <h2 style="color: var(--primary-color); margin-bottom: 10px;">Order Confirmed!</h2>
                            <p style="color: #666;">Order #${order.id}</p>
                        </div>
                        
                        <div style="
                            background: var(--light-color);
                            border-radius: 15px;
                            padding: 20px;
                            margin-bottom: 25px;
                        ">
                            <h3 style="color: var(--primary-color); margin-bottom: 15px;">
                                <i class="fas fa-info-circle"></i> Order Details
                            </h3>
                            
                            <div style="margin-bottom: 15px;">
                                <div style="display: flex; justify-content: space-between; margin-bottom: 8px;">
                                    <span style="font-weight: 600;">Customer:</span>
                                    <span>${order.customerName}</span>
                                </div>
                                <div style="display: flex; justify-content: space-between; margin-bottom: 8px;">
                                    <span style="font-weight: 600;">Phone:</span>
                                    <span>${order.customerPhone}</span>
                                </div>
                                <div style="display: flex; justify-content: space-between; margin-bottom: 8px;">
                                    <span style="font-weight: 600;">Delivery Type:</span>
                                    <span>${isDelivery ? 'Delivery' : 'Pickup'}</span>
                                </div>
                                <div style="display: flex; justify-content: space-between; margin-bottom: 8px;">
                                    <span style="font-weight: 600;">Payment:</span>
                                    <span>${getPaymentMethodName(order.payment.method)}</span>
                                </div>
                            </div>
                            
                            ${isDelivery ? `
                                <div style="background: white; border-radius: 10px; padding: 15px; margin-top: 10px;">
                                    <h4 style="color: var(--primary-color); margin-bottom: 10px;">
                                        <i class="fas fa-map-marker-alt"></i> Delivery Address
                                    </h4>
                                    <p style="color: var(--dark-color);">${order.delivery.address}</p>
                                    ${order.delivery.instructions ? `
                                        <p style="margin-top: 10px; color: #777;">
                                            <i class="fas fa-sticky-note"></i> Instructions: ${order.delivery.instructions}
                                        </p>
                                    ` : ''}
                                </div>
                            ` : `
                                <div style="background: white; border-radius: 10px; padding: 15px; margin-top: 10px;">
                                    <h4 style="color: var(--primary-color); margin-bottom: 10px;">
                                        <i class="fas fa-store"></i> Pickup Information
                                    </h4>
                                    <p style="color: var(--dark-color);">
                                        <i class="fas fa-map-marker-alt"></i> ${order.delivery.storeAddress}
                                    </p>
                                    <p style="margin-top: 10px; color: #777;">
                                        <i class="fas fa-clock"></i> Pickup Time: ${order.delivery.pickupTime}
                                    </p>
                                </div>
                            `}
                        </div>
                        
                        <div style="
                            text-align: center;
                            background: linear-gradient(135deg, var(--primary-color) 0%, var(--accent-color) 100%);
                            color: white;
                            padding: 20px;
                            border-radius: 15px;
                            margin-bottom: 25px;
                        ">
                            <div style="font-size: 0.9rem; margin-bottom: 5px;">Total Amount</div>
                            <div style="font-size: 2rem; font-weight: 700;">â‚±${order.total.toFixed(2)}</div>
                            <div style="font-size: 0.9rem; margin-top: 5px; opacity: 0.9;">
                                Includes ${isDelivery ? 'â‚±50.00 delivery fee' : 'no delivery fee'}
                            </div>
                        </div>
                        
                        <p style="text-align: center; color: #666; margin-bottom: 25px;">
                            <i class="fas fa-clock"></i> Estimated ${isDelivery ? 'delivery' : 'pickup'} time: 
                            ${new Date(order.estimatedTime).toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'})}
                        </p>
                        
                        <div style="display: flex; gap: 10px;">
                            <button onclick="closeOrderConfirmation()" style="
                                flex: 1;
                                padding: 12px;
                                background: var(--primary-color);
                                color: white;
                                border: none;
                                border-radius: 12px;
                                font-size: 1rem;
                                font-weight: 600;
                                cursor: pointer;
                                transition: all 0.3s ease;
                                display: flex;
                                align-items: center;
                                justify-content: center;
                                gap: 8px;
                            " onmouseover="this.style.background='var(--accent-color')" 
                            onmouseout="this.style.background='var(--primary-color')">
                                <i class="fas fa-home"></i> Back to Menu
                            </button>
                            <button onclick="viewOrderStatus()" style="
                                flex: 1;
                                padding: 12px;
                                background: var(--info-color);
                                color: white;
                                border: none;
                                border-radius: 12px;
                                font-size: 1rem;
                                font-weight: 600;
                                cursor: pointer;
                                transition: all 0.3s ease;
                                display: flex;
                                align-items: center;
                                justify-content: center;
                                gap: 8px;
                            " onmouseover="this.style.background='#0b7dda'" 
                            onmouseout="this.style.background='var(--info-color')">
                                <i class="fas fa-clipboard-list"></i> Track Order
                            </button>
                        </div>
                    </div>
                </div>
            `;
            
            const confirmationModal = document.createElement('div');
            confirmationModal.innerHTML = confirmationHTML;
            document.body.appendChild(confirmationModal);
        }

        // Add these global functions
        function closeOrderConfirmation() {
            const modal = document.getElementById('order-confirmation-modal');
            if (modal) {
                modal.remove();
            }
        }

        function viewOrderStatus() {
            const modal = document.getElementById('order-confirmation-modal');
            if (modal) {
                modal.remove();
            }
            openOrderStatus();
        }

        // Close modal with Escape key
        document.addEventListener('keydown', (e) => {
            if (e.key === 'Escape') {
                if (checkoutModal.classList.contains('open')) {
                    closeCheckoutModal();
                }
                closeOrderConfirmation();
            }
        });

        // Initialize form validation
        document.querySelectorAll('#checkout-modal input, #checkout-modal textarea').forEach(input => {
            input.addEventListener('input', function() {
                if (this.value.trim()) {
                    this.style.borderColor = '#ddd';
                }
            });
        });

        // Card number formatting
        const cardNumberInput = document.getElementById('card-number');
        if (cardNumberInput) {
            cardNumberInput.addEventListener('input', function(e) {
                let value = e.target.value.replace(/\D/g, '');
                value = value.replace(/(\d{4})(?=\d)/g, '$1 ');
                e.target.value = value.substring(0, 19); // Max 16 digits + 3 spaces
            });
        }

        // Card expiry formatting
        const cardExpiryInput = document.getElementById('card-expiry');
        if (cardExpiryInput) {
            cardExpiryInput.addEventListener('input', function(e) {
                let value = e.target.value.replace(/\D/g, '');
                if (value.length >= 2) {
                    value = value.substring(0, 2) + '/' + value.substring(2, 4);
                }
                e.target.value = value.substring(0, 5); // MM/YY
            });
        }

        // CVV formatting
        const cardCvvInput = document.getElementById('card-cvv');
        if (cardCvvInput) {
            cardCvvInput.addEventListener('input', function(e) {
                let value = e.target.value.replace(/\D/g, '');
                e.target.value = value.substring(0, 3); // Max 3 digits
            });
        }

        document.addEventListener('DOMContentLoaded', async function() {
            console.log('Customer page loaded');
            createParticles();
            
            // Load and generate menu
            await generateMenu();
            
            // Setup auto-refresh
            setupMenuAutoRefresh();
        });

        // Check for menu updates every 30 seconds
        setInterval(() => {
            fetch('/menu-data.json?' + new Date().getTime())
                .then(response => response.json())
                .then(data => {
                    const currentData = JSON.stringify(loadMenuData());
                    const newData = JSON.stringify(data);
                    
                    if (currentData !== newData) {
                        console.log('Menu data updated, refreshing...');
                        localStorage.setItem('coffeeShopMenuData', JSON.stringify(data));
                        location.reload();
                    }
                })
                .catch(() => {
                    console.log('Could not fetch updated menu data');
                });
        }, 30000);
    </script>
</body>
</html>
[file content end]